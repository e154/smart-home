<!doctype html><html lang=en class=no-js>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=generator content="Hugo 0.89.4"><link rel=canonical type=text/html href=https://e154.github.io/smart-home/docs/dashboard/>
<meta name=ROBOTS content="NOINDEX, NOFOLLOW">
<link rel="shortcut icon" href=/smart-home/favicons/favicon.ico>
<link rel=apple-touch-icon href=/smart-home/favicons/apple-touch-icon-180x180.png sizes=180x180>
<link rel=icon type=image/png href=/smart-home/favicons/favicon-16x16.png sizes=16x16>
<link rel=icon type=image/png href=/smart-home/favicons/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/smart-home/favicons/android-36x36.png sizes=36x36>
<link rel=icon type=image/png href=/smart-home/favicons/android-48x48.png sizes=48x48>
<link rel=icon type=image/png href=/smart-home/favicons/android-72x72.png sizes=72x72>
<link rel=icon type=image/png href=/smart-home/favicons/android-96x96.png sizes=96x96>
<link rel=icon type=image/png href=/smart-home/favicons/android-144x144.png sizes=144x144>
<link rel=icon type=image/png href=/smart-home/favicons/android-192x192.png sizes=192x192>
<title>Dashboard | Smart home</title>
<meta name=description content="

     


 
 
The Smart Home project includes a powerful dashboard builder that allows users to create custom user interfaces for controlling and …">
<meta property="og:title" content="Dashboard">
<meta property="og:description" content="The program complex">
<meta property="og:type" content="website">
<meta property="og:url" content="https://e154.github.io/smart-home/docs/dashboard/"><meta property="og:site_name" content="Smart home">
<meta itemprop=name content="Dashboard">
<meta itemprop=description content="The program complex"><meta name=twitter:card content="summary">
<meta name=twitter:title content="Dashboard">
<meta name=twitter:description content="The program complex">
<link rel=preload href=/smart-home/scss/main.min.bd5285b713d3061549a6bfd34e5f4ec6775ede36672a3088260f0d420050647f.css as=style>
<link href=/smart-home/scss/main.min.bd5285b713d3061549a6bfd34e5f4ec6775ede36672a3088260f0d420050647f.css rel=stylesheet integrity>
<script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
</head>
<body class=td-section>
<header>
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
<a class=navbar-brand href=/smart-home/>
<span class=navbar-logo></span><span class="text-uppercase font-weight-bold">Smart home</span>
</a>
<div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar>
<ul class="navbar-nav mt-2 mt-lg-0">
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class="nav-link active" href=/smart-home/docs/><span class=active>Documentation</span></a>
</li>
<li class="nav-item dropdown mr-4 d-none d-lg-block">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
English
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=/smart-home/ru/docs/dashboard/>Русский</a>
</div>
</li>
</ul>
</div>
<div class="navbar-nav d-none d-lg-block">
</div>
</nav>
</header>
<div class="container-fluid td-outer">
<div class=td-main>
<div class="row flex-xl-nowrap">
<div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
</div>
<div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
</div>
<main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main>
<div class=td-content>
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.
</p><p>
<a href=/smart-home/docs/dashboard/>Return to the regular view of this page</a>.
</p>
</div>
<h1 class=title>Dashboard</h1>
<ul>
<li>1: <a href=#pg-79dd35eaf760c41d2392591d635dd60b>Gate</a></li>
<ul>
</ul>
<li>2: <a href=#pg-6bea25be625ccc9f997ef24efc5fe445>Entity</a></li>
<li>3: <a href=#pg-92a1ce490d5b2270e82a38d7ec4e5f5e>Automation</a></li>
<ul>
<li>3.1: <a href=#pg-aaf9a804d05304e1c407d1bed1fc2aff>Tasks</a></li>
<li>3.2: <a href=#pg-663b794f38e2652ec4da941b3cce1ac3>Actions</a></li>
<li>3.3: <a href=#pg-f398915e040cbcdbf88478a38ed8f7c1>Conditions</a></li>
<li>3.4: <a href=#pg-649333aa8bab35b619f6967595405b2d>Triggers</a></li>
</ul>
<li>4: <a href=#pg-4177dcddfec763697e168bfb1da48ab1>MQTT</a></li>
<ul>
</ul>
</ul>
<div class=content>
<figure>
<img src=/smart-home/dashboard1.png>
</figure>
<p> </p>
<p> </p>
<p>The Smart Home project includes a powerful dashboard builder that allows users to create custom user interfaces for controlling and managing their smart homes.</p>
<p>The dashboard builder provides a flexible and intuitive way to customize the visual representation of the smart home. Users can create personalized control panels by arranging widgets and controls in a convenient order.</p>
<p>Using the dashboard builder, you can add and configure various widgets such as control buttons, sliders, sensors, graphs, and more. You can choose and arrange these widgets on the control panel to display and control the devices and functions you need.</p>
<p>The dashboard builder also allows you to create custom layouts and widget groups to organize and structure the control panel. This enables users to create multiple control panels for different zones or functional areas of the smart home.</p>
<p>With the flexible settings and features of the dashboard builder, you can create unique user interfaces that display and control your devices and smart home systems in a way that suits your preferences and style. You can choose color schemes, fonts, widget placement, and other parameters to create a control panel that matches your preferences and style.</p>
<p>In the documentation of the Smart Home project, you will find detailed instructions on how to use the dashboard builder, as well as examples of creating and configuring custom interfaces. This will allow you to create an individual and convenient user experience for managing your smart home and interacting with its features.</p>
</div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-79dd35eaf760c41d2392591d635dd60b>1 - Gate</h1>
<figure>
<img src=/smart-home/img/gate-network.svg>
</figure>
<p>Gate Server in the Smart Home system is a key component that provides secure and convenient remote access to the smart home, even in the absence of a static IP address. This server enables users to control and monitor their home from anywhere in the world via the internet, ensuring data security and comfortable interaction.</p>
<h4 id=advantages-of-the-gate-server-in-the-smart-home-system>Advantages of the Gate Server in the Smart Home System</h4>
<ol>
<li>
<p><strong>Security:</strong></p>
<ul>
<li><strong>Data Encryption:</strong> All data transmitted between devices and the Gate Server is encrypted to prevent unauthorized access.</li>
<li><strong>Authentication:</strong> Built-in authentication mechanisms ensure that only authorized users have access to the system.</li>
</ul>
</li>
<li>
<p><strong>Convenience of Remote Access:</strong></p>
<ul>
<li><strong>No White IP:</strong> Users can connect to the system even without a static IP address, making remote access more convenient and accessible.</li>
</ul>
</li>
<li>
<p><strong>Configuration Flexibility:</strong></p>
<ul>
<li><strong>Connect to Test Gateway:</strong> Smart Home provides a built-in Gate client that can connect to a test gateway at <a href=https://gate.e154.ru:8443>https://gate.e154.ru:8443</a> for testing and configuring remote access.</li>
</ul>
</li>
<li>
<p><strong>Scalability:</strong></p>
<ul>
<li><strong>Support for Multiple Devices:</strong> The Gate Server is designed to handle simultaneous requests from multiple devices, ensuring system scalability.</li>
</ul>
</li>
</ol>
<h4 id=working-with-the-gate-client-in-the-smart-home-system>Working with the Gate Client in the Smart Home System</h4>
<ol>
<li>
<p><strong>Setting Up the Gate Client:</strong></p>
<ul>
<li>Enable the Gate Server mode in the Smart Home system, specifying the address of the test gateway or setting up your Gate Server.</li>
<li>Configure security parameters such as encryption and authentication.</li>
</ul>
</li>
<li>
<p><strong>Connecting to the Gate Server:</strong></p>
<ul>
<li>The Gate client automatically establishes a secure connection with the Gate Server, without requiring a white IP address.</li>
<li>Users can use mobile applications or the web interface for remote access.</li>
</ul>
</li>
<li>
<p><strong>Secure Remote Management:</strong></p>
<ul>
<li>Users can control devices, monitor the home&rsquo;s status, and receive notifications even when away from home.</li>
</ul>
</li>
</ol>
<h3 id=server-configuration>Server Configuration</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat config.gate.json

<span style=color:#ce5c00;font-weight:700>{</span>
  <span style=color:#4e9a06>&#34;api_http_port&#34;</span>: 8080,
  <span style=color:#4e9a06>&#34;api_https_port&#34;</span>: 8443,
  <span style=color:#4e9a06>&#34;api_debug&#34;</span>: false,
  <span style=color:#4e9a06>&#34;api_gzip&#34;</span>: true,
  <span style=color:#4e9a06>&#34;pprof&#34;</span>: false,
  <span style=color:#4e9a06>&#34;domain&#34;</span>: <span style=color:#4e9a06>&#34;localhost&#34;</span>,
  <span style=color:#4e9a06>&#34;https&#34;</span>: false,
  <span style=color:#4e9a06>&#34;proxy_timeout&#34;</span>: 5,
  <span style=color:#4e9a06>&#34;proxy_idle_timeout&#34;</span>: 10,
  <span style=color:#4e9a06>&#34;proxy_secret_key&#34;</span>: <span style=color:#4e9a06>&#34;&#34;</span>
<span style=color:#ce5c00;font-weight:700>}</span>
</code></pre></div><p>Properties for the <code>config.gate.json</code> configuration file:</p>
<ol>
<li>
<p><strong><code>api_http_port</code> (int):</strong></p>
<ul>
<li><strong>Description:</strong> Port for the HTTP API server.</li>
<li><strong>Example Value:</strong> <code>8080</code>.</li>
</ul>
</li>
<li>
<p><strong><code>api_https_port</code> (int):</strong></p>
<ul>
<li><strong>Description:</strong> Port for the HTTPS API server.</li>
<li><strong>Example Value:</strong> <code>8443</code>.</li>
</ul>
</li>
<li>
<p><strong><code>api_debug</code> (bool):</strong></p>
<ul>
<li><strong>Description:</strong> Enable debug mode for the API server.</li>
<li><strong>Example Value:</strong> <code>true</code> (enabled).</li>
</ul>
</li>
<li>
<p><strong><code>api_gzip</code> (bool):</strong></p>
<ul>
<li><strong>Description:</strong> Enable Gzip compression for API requests.</li>
<li><strong>Example Value:</strong> <code>true</code> (enabled).</li>
</ul>
</li>
<li>
<p><strong><code>domain</code> (string):</strong></p>
<ul>
<li><strong>Description:</strong> Domain name for the Gate server.</li>
<li><strong>Example Value:</strong> <code>example.com</code>.</li>
</ul>
</li>
<li>
<p><strong><code>pprof</code> (bool):</strong></p>
<ul>
<li><strong>Description:</strong> Enable server profiling mode.</li>
<li><strong>Example Value:</strong> <code>true</code> (enabled).</li>
</ul>
</li>
<li>
<p><strong><code>https</code> (bool):</strong></p>
<ul>
<li><strong>Description:</strong> Enable the use of Let&rsquo;s Encrypt for automatic SSL certificate acquisition for the specified domain.</li>
<li><strong>Example Value:</strong> <code>true</code> (enabled).</li>
</ul>
</li>
<li>
<p><strong><code>proxy_timeout</code> (int):</strong></p>
<ul>
<li><strong>Description:</strong> Timeout for proxy connections in seconds.</li>
<li><strong>Example Value:</strong> <code>5</code>.</li>
</ul>
</li>
<li>
<p><strong><code>proxy_idle_timeout</code> (int):</strong></p>
<ul>
<li><strong>Description:</strong> Timeout for proxy connections in seconds when there is no activity.</li>
<li><strong>Example Value:</strong> <code>10</code>.</li>
</ul>
</li>
<li>
<p><strong><code>proxy_secret_key</code> (string):</strong></p>
</li>
</ol>
<ul>
<li><strong>Description:</strong> Secret key to ensure the security of proxy connections.</li>
<li><strong>Example Value:</strong> <code>mySecretKey</code>.</li>
</ul>
<p>These parameters provide flexible control over the settings of the Gate server, including security, operating modes, and the use of SSL certificates via Let&rsquo;s Encrypt.</p>
<h3 id=server-launch>Server Launch</h3>
<p>The Gate server is integrated into the smart-home system as a separate mode by specifying the <code>gate</code> argument during startup.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>./smart-home <span style=color:#204a87>help</span> gate
Organization of remote access without white IP

Usage:
  server gate <span style=color:#ce5c00;font-weight:700>[</span>flags<span style=color:#ce5c00;font-weight:700>]</span>

Flags:
  -h, --help   <span style=color:#204a87>help</span> <span style=color:#204a87;font-weight:700>for</span> gate


./smart-home gate

  ___      _
 / __<span style=color:#000;font-weight:700>|</span>__ _<span style=color:#000;font-weight:700>|</span> <span style=color:#000;font-weight:700>|</span>_ ___
<span style=color:#000;font-weight:700>|</span> <span style=color:#ce5c00;font-weight:700>(</span>_ / _<span style=color:#a40000>&#39;</span> <span style=color:#000;font-weight:700>|</span>  _/ -_<span style=color:#ce5c00;font-weight:700>)</span>
 <span style=color:#4e9a06>\_</span>__<span style=color:#4e9a06>\_</span>_,_<span style=color:#000;font-weight:700>|</span><span style=color:#4e9a06>\_</span>_<span style=color:#4e9a06>\_</span>__<span style=color:#000;font-weight:700>|</span>


INFO	gate            	server/gate_server.go:93 &gt;	Started ...
INFO	gate            	server/server.go:117 &gt;	server started at :8080
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-6bea25be625ccc9f997ef24efc5fe445>2 - Entity</h1>
<figure>
<img src=/smart-home/img/entity.svg>
</figure>
<p>This is a simple scheme that represents an &ldquo;Entity&rdquo; object. Each component has its role and functionality in managing and monitoring the &ldquo;Entity&rdquo; object in a smart home.</p>
<p>The &ldquo;Entity&rdquo; object is a central element of the Smart Home system and combines various aspects of the object, its states, attributes, actions, settings, and metrics. This allows the system to efficiently control and monitor objects in a smart home.</p>
<p>Here is a detailed description of the components of the &ldquo;Entity&rdquo; object:</p>
<p>Actions: The &ldquo;Entity&rdquo; object can receive and process various actions or commands. Actions are operations that can be performed on the object, such as turning on, turning off, changing parameters, etc.</p>
<p>State: The &ldquo;Entity&rdquo; object has a list of states it can transition into. At any given moment, the object can be in only one state. Examples of states may include &ldquo;On,&rdquo; &ldquo;Off,&rdquo; &ldquo;Standby,&rdquo; &ldquo;Playing,&rdquo; etc.</p>
<p>Attributes: Attributes are a storage of the object&rsquo;s state. It is a predefined list of fields and properties that contain information about the current state of the object. Attributes can be represented as a map[string]any, where the key is the attribute name, and the value is the corresponding attribute value.</p>
<p>Settings: The settings of the &ldquo;Entity&rdquo; object are a pre-defined list of immutable fields and properties. They define the configuration parameters of the object that can be set during its setup. Settings can also be represented as a map[string]any.</p>
<p>Metrics: The metrics of the &ldquo;Entity&rdquo; object provide information about its attributes or state, which is used for monitoring and measuring the performance or behavior of the object. Metrics can include data such as the average value of an attribute, the number of state changes, etc.</p>
<p>Storage: The storage of the &ldquo;Entity&rdquo; object provides a history of changes to its state or attributes. It records and stores previous values, allowing for tracking and analyzing the object&rsquo;s change history. The storage can be used for displaying graphs, analytics, or performing other operations with historical data of the object.</p>
<p>The &ldquo;Entity&rdquo; object brings all these components together, providing a unified and flexible approach to managing and monitoring various devices and systems in a smart home.</p>
<p>In the Smart Home system, each &ldquo;Entity&rdquo; object is implemented based on a specific plugin. Plugins provide different functionalities and capabilities for the &ldquo;Entity&rdquo; objects in the system. Some popular plugins that can be used to create &ldquo;Entity&rdquo; objects include sensor, mqtt, weather, automation, and others.</p>
<p>When a new &ldquo;Entity&rdquo; object is created, it is associated with a specific plugin that determines its functionality and capabilities. For example, if the &ldquo;Entity&rdquo; object represents a sensor, the sensor plugin can be used for its implementation. If the &ldquo;Entity&rdquo; object is intended to interact with an MQTT broker, the mqtt plugin can be used for it.</p>
<p>Each plugin provides its own handlers and methods that allow &ldquo;Entity&rdquo; objects to perform specific actions, retrieve data, send messages, etc.</p>
<figure>
<img src=/smart-home/img/entity_plugins.svg>
</figure>
<p>On the diagram, the general structure of the relationship between &ldquo;Entity&rdquo; objects, plugins, and the automation component in the Smart Home system is presented.</p>
<p>Smart Home is the central part of the system and coordinates the interaction between all the components.
&ldquo;Entity&rdquo; objects represent specific devices, sensors, or other components in the system. Each &ldquo;Entity&rdquo; object can use a specific plugin for its implementation.
Plugins provide functionality and capabilities for the &ldquo;Entity&rdquo; objects. They contain logic and methods that allow &ldquo;Entity&rdquo; objects to interact with external devices, gather data, send commands, etc.
The automation component is responsible for creating scenarios and triggering specific actions based on conditions and triggers. It can use &ldquo;Entity&rdquo; objects and their plugins to define conditions, triggers, and actions in the scenarios.
This structure allows the Smart Home system to be flexible and extensible, as new plugins and &ldquo;Entity&rdquo; objects can be added, and the automation component can use them to create various scenarios and automate actions.</p>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-92a1ce490d5b2270e82a38d7ec4e5f5e>3 - Automation</h1>
<p>The system includes an &ldquo;Automation&rdquo; component designed to implement scenarios and automated responses to specific actions or events. It allows you to create and configure automatic actions that are triggered when certain conditions or triggers are met.</p>
<p>The &ldquo;Automation&rdquo; component provides capabilities for creating complex scenarios, combining multiple actions, checking conditions, and interacting with various devices or services in the system. Each scenario consists of three main components: Triggers, Conditions, and Actions.</p>
<p>Here is a schematic representation of the automation scenario:</p>
<pre tabindex=0><code>              +----------------+
              |   Triggers     |
              +-------+--------+
                      |
                      v
              +----------------+
              |  Conditions    |
              +-------+--------+
                      |
                      v
              +----------------+
              |   Actions      |
              +----------------+
</code></pre><ol>
<li>
<p>Triggers:</p>
<ul>
<li>Triggers initiate the execution of a scenario. They can be associated with events such as a change in device status, receiving a command from a user, timer expiration, and more.</li>
</ul>
</li>
<li>
<p>Conditions:</p>
<ul>
<li>Conditions determine whether additional checks need to be satisfied for the scenario to be executed. For example, a condition may check the current time of day, the state of a specific device, or other factors.</li>
</ul>
</li>
<li>
<p>Actions:</p>
<ul>
<li>Actions define the tasks to be performed when the scenario is executed. This can include changing the state of devices, sending commands to other devices, executing an HTTP request, sending notifications, and other actions.</li>
</ul>
</li>
</ol>
<p>The entire automation system is built around these components, allowing you to create complex scenarios that respond to events and perform specific tasks in your smart home.</p>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-aaf9a804d05304e1c407d1bed1fc2aff>3.1 - Tasks</h1>
<figure>
<img src=/smart-home/tasks_window1.png>
</figure>
<h3 id=automation-through-tasks-in-the-smart-home-system>Automation through Tasks in the Smart Home System</h3>
<p>The Smart Home system provides a powerful automation mechanism through the use of Tasks. Tasks are programmatic scenarios that are triggered in response to specific events, executed when conditions are met, and can impact devices in the home through a set of actions. This ensures flexibility and intelligence in managing a smart home.</p>
<h4 id=components-of-a-task>Components of a Task</h4>
<ol>
<li>
<p><strong>Triggers:</strong></p>
<ul>
<li><strong>Event Definition:</strong> A task begins execution in response to specific events, such as changes in the state of a device, temporal events, sensors, and other external factors.</li>
<li><strong>Example:</strong> Initiating a task when a door is opened, when there&rsquo;s motion in a room, on a schedule, etc.</li>
</ul>
</li>
<li>
<p><strong>Conditions:</strong></p>
<ul>
<li><strong>Execution Logic:</strong> A task can contain conditions that determine whether actions should be executed based on the current state of the system.</li>
<li><strong>Example:</strong> Execute actions only if the room temperature is above a certain threshold.</li>
</ul>
</li>
<li>
<p><strong>Actions:</strong></p>
<ul>
<li><strong>Device Management:</strong> A task can influence devices in the system by changing their states, issuing commands, and performing other actions.</li>
<li><strong>Example:</strong> Turn on the lights when there is motion in the corridor, send a notification when a door is open.</li>
</ul>
</li>
</ol>
<h4 id=advantages-of-automation-through-tasks>Advantages of Automation through Tasks</h4>
<ol>
<li>
<p><strong>Flexibility in Configuration:</strong></p>
<ul>
<li>Users can create complex automation scenarios by combining various triggers, conditions, and actions to suit their needs.</li>
</ul>
</li>
<li>
<p><strong>Intelligent Scenarios:</strong></p>
<ul>
<li>Automatic response to events and changes in the system makes the smart home more intelligent, providing a personalized experience.</li>
</ul>
</li>
<li>
<p><strong>Efficient Energy Consumption:</strong></p>
<ul>
<li>Automation can be configured to optimize energy consumption, such as turning off lights and heating when there are no people in the house.</li>
</ul>
</li>
<li>
<p><strong>Management of Multiple Devices:</strong></p>
<ul>
<li>Tasks allow simultaneous control of multiple devices, creating complex scenarios.</li>
</ul>
</li>
<li>
<p><strong>Ease of Use:</strong></p>
<ul>
<li>The intuitive interface of the Smart Home system makes it easy for both novice and experienced users to create and manage tasks.</li>
</ul>
</li>
</ol>
<h4 id=example-of-a-scenario-through-tasks>Example of a Scenario through Tasks</h4>
<ol>
<li><strong>Scenario &ldquo;Welcome&rdquo;:</strong>
<ul>
<li><strong>Triggers:</strong>
<ul>
<li>Upon opening the door.</li>
</ul>
</li>
<li><strong>Conditions:</strong>
<ul>
<li>If it is morning or daytime.</li>
</ul>
</li>
<li><strong>Actions:</strong>
<ul>
<li>Turn on the lights in the hallway.</li>
<li>Start playing music on the audio system.</li>
<li>Send a notification that someone has arrived.</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>This scenario demonstrates how a task can be used to automate welcoming actions upon opening the door during specific times of the day.</p>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-663b794f38e2652ec4da941b3cce1ac3>3.2 - Actions</h1>
<figure>
<img src=/smart-home/actions_window1.png>
</figure>
<p> </p>
<p> </p>
<p>Actions define the tasks that need to be performed when the scenario is executed. This can include changing the state of devices, sending commands to other devices, executing an HTTP request, sending notifications, and other actions.</p>
<p>Example implementation of an action handler:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>automationAction = </span><span style=color:#000>(entityId)-&gt;</span>
    <span style=color:#000>EntityCallAction</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>entityId</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;ON&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>{})</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-f398915e040cbcdbf88478a38ed8f7c1>3.3 - Conditions</h1>
<figure>
<img src=/smart-home/condition_window1.png>
</figure>
<p> </p>
<p> </p>
<p>A condition defines an additional check that needs to be performed before executing the scenario. This condition can check the current state of a device or other factors. The condition is an optional component, and if it is present, the execution of the scenario will depend on its result.</p>
<p>Example implementation of a condition handler:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>automationCondition = </span><span style=color:#000>(entityId)-&gt;</span>
    <span style=color:#000>entity = </span><span style=color:#000>EntityGetState</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>entityId</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>entity</span> <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>entity</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>state</span> 
        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>entity</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>state</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#4e9a06>&#39;ON&#39;</span>
        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>true</span>
    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-649333aa8bab35b619f6967595405b2d>3.4 - Triggers</h1>
<figure>
<img src=/smart-home/triggers_window1.png>
</figure>
<p>Triggers in the Smart Home system are key elements that initiate the execution of tasks in response to specific events or conditions. Currently, the system supports three main types of triggers, each with its advantages, providing flexibility in automation configuration.</p>
<h4 id=1-trigger-state-change>1. <strong>Trigger &ldquo;State Change&rdquo;:</strong></h4>
<ul>
<li>
<p><strong>Description:</strong></p>
<ul>
<li>Activates upon the change of the state of a specific device or group of devices in the Smart Home system.</li>
</ul>
</li>
<li>
<p><strong>Advantages:</strong></p>
<ul>
<li><strong>Reacting to Changes:</strong> Ideal for scenarios where specific reactions are needed, such as turning lights on/off, opening doors, etc.</li>
<li><strong>Customization Flexibility:</strong> Allows selecting specific devices and state parameters for triggering.</li>
</ul>
</li>
</ul>
<h4 id=2-trigger-system>2. <strong>Trigger &ldquo;System&rdquo;:</strong></h4>
<ul>
<li>
<p><strong>Description:</strong></p>
<ul>
<li>Activates upon the occurrence of system events, such as system start/stop, device connection/disconnection, and other events on the system bus.</li>
</ul>
</li>
<li>
<p><strong>Advantages:</strong></p>
<ul>
<li><strong>System Monitoring:</strong> Used for monitoring the overall system state and detecting events related to the functioning of the smart home.</li>
<li><strong>Integration with External Systems:</strong> Enables interaction with systems operating within the system bus.</li>
</ul>
</li>
</ul>
<h4 id=3-trigger-time-cron>3. <strong>Trigger &ldquo;Time (Cron)":</strong></h4>
<ul>
<li>
<p><strong>Description:</strong></p>
<ul>
<li>Activates at specified time intervals according to a schedule defined in cron format.</li>
</ul>
</li>
<li>
<p><strong>Advantages:</strong></p>
<ul>
<li><strong>Regular Execution:</strong> Ideal for tasks that need to be executed regularly on a schedule.</li>
<li><strong>Energy Savings:</strong> Can be used to optimize energy consumption, such as turning off lights or heating during nighttime.</li>
</ul>
</li>
</ul>
<h4 id=examples-of-trigger-usage>Examples of Trigger Usage</h4>
<ol>
<li>
<p><strong>Trigger &ldquo;State Change&rdquo;:</strong></p>
<ul>
<li><strong>Scenario:</strong>
<ul>
<li>Turn on the air conditioner when the window in the bedroom is opened.</li>
</ul>
</li>
<li><strong>Trigger Configuration:</strong>
<ul>
<li>Device: Window in the bedroom.</li>
<li>State: Open.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Trigger &ldquo;System&rdquo;:</strong></p>
<ul>
<li><strong>Scenario:</strong>
<ul>
<li>Send a notification upon connecting a new device to the system.</li>
</ul>
</li>
<li><strong>Trigger Configuration:</strong>
<ul>
<li>System Event: Connection of a new device.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Trigger &ldquo;Time (Cron)":</strong></p>
<ul>
<li><strong>Scenario:</strong>
<ul>
<li>Turn off the lights in all rooms after midnight.</li>
</ul>
</li>
<li><strong>Trigger Configuration:</strong>
<ul>
<li>Time Interval: &ldquo;0 0 * * *&rdquo; corresponding to every midnight.</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id=examples-in-coffeescript>Examples in Coffeescript</h4>
<ol>
<li><code>TriggerAlexa</code>:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>automationTriggerAlexa = </span><span style=color:#000>(msg) -&gt;</span>
  <span style=color:#000>p = </span><span style=color:#000>msg</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>payload</span>
  <span style=color:#000>Done</span> <span style=color:#000>p</span>
  <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span>
</code></pre></div><p>The <code>automationTriggerAlexa</code> handler is called in response to a trigger from Amazon Alexa. It takes the message object <code>msg</code> and can perform specific actions related to this trigger.</p>
<ol start=2>
<li><code>TriggerStateChanged</code>:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>automationTriggerStateChanged = </span><span style=color:#000>(msg) -&gt;</span>
  <span style=color:#000>p = </span><span style=color:#000>msg</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>payload</span>
  <span style=color:#000>Done</span> <span style=color:#000>p</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>new_state</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>state</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>name</span>
  <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span>
</code></pre></div><p>The <code>automationTriggerStateChanged</code> handler is called when the state of a device changes. It takes the message object
<code>msg</code> and can perform specific actions based on the new state of the device.</p>
<ol start=3>
<li><code>TriggerSystem</code>:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>automationTriggerSystem = </span><span style=color:#000>(msg) -&gt;</span>
  <span style=color:#000>p = </span><span style=color:#000>msg</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>payload</span>
  <span style=color:#000>Done</span> <span style=color:#000>p</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>event</span>
  <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span>
</code></pre></div><p>The <code>automationTriggerSystem</code> handler is called in response to system events. It takes the message object <code>msg</code> and can perform specific actions related to this event.</p>
<ol start=4>
<li><code>TriggerTime</code>:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>automationTriggerTime = </span><span style=color:#000>(msg) -&gt;</span>
  <span style=color:#000>p = </span><span style=color:#000>msg</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>payload</span>
  <span style=color:#000>Done</span> <span style=color:#000>p</span>
  <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span>
</code></pre></div><p>The <code>automationTriggerTime</code> handler is called after a specified period of time has elapsed. It takes the message object <code>msg</code> and can perform specific actions related to this time.</p>
<p>Each trigger handler can execute the necessary logic in response to the corresponding trigger and then return the value <code>false</code> to indicate that further processing is not required.</p>
<p>Example implementation:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>automationTriggerStateChanged = </span><span style=color:#000>(msg)-&gt;</span>
    <span style=color:#000>p = </span><span style=color:#000>msg</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>payload</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>p</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>new_state</span> <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>p</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>new_state</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>state</span>
        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87;font-weight:700>false</span>
    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>msg</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>new_state</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>state</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#4e9a06>&#39;DOUBLE_CLICK&#39;</span>
</code></pre></div><h4 id=conclusion>Conclusion</h4>
<p>The use of different types of triggers in the Smart Home system allows users to create complex and intelligent automation scenarios that seamlessly respond to changes in the system and external events. This provides users with a personalized and efficient smart home experience.</p>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-4177dcddfec763697e168bfb1da48ab1>4 - MQTT</h1>
<p>The <strong>Smart Home</strong> project system includes a built-in MQTT broker, which allows for message exchange and device control in the smart home using the MQTT (Message Queuing Telemetry Transport) protocol.</p>
<p>MQTT is a lightweight messaging protocol designed for exchanging data between devices in networks with limited bandwidth or unreliable connections. It is based on the publisher-subscriber model and provides reliable message delivery between devices.</p>
<p>The built-in MQTT broker in the <strong>Smart Home</strong> project provides the server-side component for handling MQTT messages. It performs the following functions:</p>
<ol>
<li>
<p>Publisher and Subscriber Support: The MQTT broker accepts messages from publishers and forwards them to subscribers. This enables devices in the smart home to exchange data and control each other.</p>
</li>
<li>
<p>Topics and Filtering: The MQTT broker uses the concept of &ldquo;topics&rdquo; to classify messages. Subscribers can subscribe to specific topics to receive only the data they are interested in. The broker filters messages and forwards them only to subscribers subscribed to the corresponding topics.</p>
</li>
<li>
<p>Guaranteed Message Delivery: The MQTT broker ensures reliable message delivery, guaranteeing that messages will be delivered to subscribers even in case of temporary connection issues or device unavailability.</p>
</li>
<li>
<p>Access Control: The MQTT broker provides authentication and authorization capabilities, allowing control over access to different topics and restricting access to devices and data in the smart home.</p>
</li>
</ol>
<p>The built-in MQTT broker in the <strong>Smart Home</strong> project simplifies the interaction and integration of devices in the smart home. It provides a stable and efficient environment for data exchange and device control using the MQTT protocol. This enables the creation of complex automation scenarios, monitoring device states, and exchanging data between different devices.</p>
</div>
</main>
</div>
</div>
<footer class="bg-dark py-5 row d-print-none">
<div class="container-fluid mx-sm-5">
<div class=row>
<div class="col-6 col-sm-4 text-xs-center order-sm-2">
</div>
<div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub>
<a class=text-white target=_blank rel=noopener href=https://github.com/e154/smart-home aria-label=GitHub>
<i class="fab fa-github"></i>
</a>
</li>
</ul>
</div>
<div class="col-12 col-sm-4 text-center py-2 order-sm-2">
<small class=text-white>&copy; 2024 Powered by <a href=http://e154.ru>e154.ru</a></small>
<div><small class="ml-1 text-white"><a href=https://github.com/e154/smart-home/blob/master/LICENSE>MIT</a> License Code Documents <a href=http://creativecommons.org/licenses/by/3.0/>CC BY 3.0</a></small></div>
</div>
</div>
</div>
</footer>
</div>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script>
<script src=/smart-home/js/tabpane-persist.js></script>
<script src=/smart-home/js/main.min.307d9740a83ff885dafd50af6ce4f79e2146b78e74ee078b11b627d0d02146a9.js integrity="sha256-MH2XQKg/+IXa/VCvbOT3niFGt4507geLEbYn0NAhRqk=" crossorigin=anonymous></script>
</body>
</html>