<!doctype html><html lang=ru class=no-js>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=generator content="Hugo 0.89.4"><link rel=canonical type=text/html href=https://e154.github.io/smart-home/docs/plugins/>
<meta name=ROBOTS content="NOINDEX, NOFOLLOW">
<link rel="shortcut icon" href=/smart-home/favicons/favicon.ico>
<link rel=apple-touch-icon href=/smart-home/favicons/apple-touch-icon-180x180.png sizes=180x180>
<link rel=icon type=image/png href=/smart-home/favicons/favicon-16x16.png sizes=16x16>
<link rel=icon type=image/png href=/smart-home/favicons/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/smart-home/favicons/android-36x36.png sizes=36x36>
<link rel=icon type=image/png href=/smart-home/favicons/android-48x48.png sizes=48x48>
<link rel=icon type=image/png href=/smart-home/favicons/android-72x72.png sizes=72x72>
<link rel=icon type=image/png href=/smart-home/favicons/android-96x96.png sizes=96x96>
<link rel=icon type=image/png href=/smart-home/favicons/android-144x144.png sizes=144x144>
<link rel=icon type=image/png href=/smart-home/favicons/android-192x192.png sizes=192x192>
<title>Расширения | Умный дом</title>
<meta name=description content="Расширение (plugins) - основной механизм добавления нового функционала. Расширение - бывает как встроенное,
загружаемое по умолчанию, так и включаемое …">
<meta property="og:title" content="Расширения">
<meta property="og:description" content="Програмный комплекс">
<meta property="og:type" content="website">
<meta property="og:url" content="https://e154.github.io/smart-home/docs/plugins/"><meta property="og:site_name" content="Умный дом">
<meta itemprop=name content="Расширения">
<meta itemprop=description content="Програмный комплекс"><meta name=twitter:card content="summary">
<meta name=twitter:title content="Расширения">
<meta name=twitter:description content="Програмный комплекс">
<link rel=preload href=/smart-home/scss/main.min.bd5285b713d3061549a6bfd34e5f4ec6775ede36672a3088260f0d420050647f.css as=style>
<link href=/smart-home/scss/main.min.bd5285b713d3061549a6bfd34e5f4ec6775ede36672a3088260f0d420050647f.css rel=stylesheet integrity>
<script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
</head>
<body class=td-section>
<header>
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
<a class=navbar-brand href=/smart-home/>
<span class=navbar-logo></span><span class="text-uppercase font-weight-bold">Умный дом</span>
</a>
<div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar>
<ul class="navbar-nav mt-2 mt-lg-0">
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class="nav-link active" href=/smart-home/docs/><span class=active>Документация</span></a>
</li>
<li class="nav-item dropdown mr-4 d-none d-lg-block">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
Русский
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=/smart-home/en/>English</a>
</div>
</li>
</ul>
</div>
<div class="navbar-nav d-none d-lg-block">
</div>
</nav>
</header>
<div class="container-fluid td-outer">
<div class=td-main>
<div class="row flex-xl-nowrap">
<div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
</div>
<div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
</div>
<main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main>
<div class=td-content>
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.
</p><p>
<a href=/smart-home/docs/plugins/>Return to the regular view of this page</a>.
</p>
</div>
<h1 class=title>Расширения</h1>
<ul>
<li>1: <a href=#pg-421d1625cd3fc0768a5e9395096f9ba0>Modbus</a></li>
<ul>
<li>1.1: <a href=#pg-83ccc62bb21aa1015dc85c4aa89b620d>Modbus rtu</a></li>
<li>1.2: <a href=#pg-2ab89625f67635397c493f87afe8c5f2>Modbus tcp</a></li>
</ul>
<li>2: <a href=#pg-a1d8fdd29f0690887aa31f7782f9e162>Alexa</a></li>
<ul>
</ul>
<li>3: <a href=#pg-ef2b94f1a2a793c6662e60a76d3c9154>Cgminer</a></li>
<ul>
<li>3.1: <a href=#pg-e8459aa132552732476b3a393a8246c7>Bitmine</a></li>
</ul>
<li>4: <a href=#pg-b9c377ed5c1bd68dd431e00f16e09761>Node</a></li>
<ul>
</ul>
<li>5: <a href=#pg-25150d443099ad5064f1a3a39214945d>Отправка сообщений</a></li>
<ul>
<li>5.1: <a href=#pg-ffcf992bf86dcf75fc98ea391689be36>Messagebird</a></li>
<li>5.2: <a href=#pg-ae8769291a804111fe0f11577b37bb14>Slack</a></li>
<li>5.3: <a href=#pg-3474b889257fbfc72d90e2b2883e468a>Telegram</a></li>
<li>5.4: <a href=#pg-8d473157f65e8e52157febb9c1671a23>Twilio</a></li>
<li>5.5: <a href=#pg-56027f5b7f86e356eca9778287b4e9b7>Шаблон сообщения</a></li>
</ul>
<li>6: <a href=#pg-8b799860c72c486736100d02c3b203e3>Scene</a></li>
<ul>
</ul>
<li>7: <a href=#pg-86ac7251d4f2a101f1d1d81f108814d2>Script</a></li>
<ul>
</ul>
<li>8: <a href=#pg-066d57f2c4c1d00c7083fef19e2b62f3>Sensor</a></li>
<ul>
</ul>
</ul>
<div class=content>
<p><strong>Расширение (plugins)</strong> - основной механизм добавления нового функционала. Расширение - бывает как встроенное,
загружаемое по умолчанию, так и включаемое пользователем (признак <em>enabled</em>). Некоторые расширения используются ядром
системы (признак <em>system</em>), такие расширения нельзя отключить.</p>
</div>
</div>
<div class=td-content>
<h1 id=pg-421d1625cd3fc0768a5e9395096f9ba0>1 - Modbus</h1>
<p>Расширение для работы с устройствами по открытому коммуникационному протоколу <strong>modbus</strong>
основанный на архитектуре ведущий — ведомый. Использует для передачи данных интерфейсы RS-485,
RS-422, RS-232, а также Ethernet сети TCP/IP (протокол Modbus TCP).</p>
<p><a href=https://ru.wikipedia.org/wiki/Modbus>wiki</a></p>
</div>
<div class=td-content>
<h1 id=pg-83ccc62bb21aa1015dc85c4aa89b620d>1.1 - Modbus rtu</h1>
<p>Modbus RTU — компактный двоичный вариант. Сообщения разделяются по паузе в линии. Сообщение должно начинаться и
заканчиваться интервалом тишины, длительностью не менее 3,5 символов при данной скорости передачи. Во время передачи
сообщения не должно быть пауз длительностью более 1,5 символов. Для скоростей более 19200 бод допускается использовать
интервалы 1,75 и 0,75 мс, соответственно. Проверка целостности осуществляется с помощью CRC.</p>
<div class="alert alert-warning" role=alert>
Для работы с modbus rtu устройством требуется настроенная <strong>нода</strong>
</div>
<h3 id=настройка>Настройка:</h3>
<ul>
<li>slave_id <code>1-32</code></li>
<li>baud <code>9600, 19200</code></li>
<li>data_bits <code>5-9</code></li>
<li>timeout <code>milliseconds</code></li>
<li>stop_bits <code>1-2</code></li>
<li>sleep <code>milliseconds</code></li>
<li>parity <code>none, odd, even</code></li>
</ul>
<h3 id=команды>Команды:</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=атрибуты>Атрибуты</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=статус>Статус</h3>
<ul>
<li>произвольный набор</li>
</ul>
<hr>
<h3 id=доступные-функции>Доступные функции</h3>
<p><strong>1 битные функции</strong></p>
<p>ReadCoils <br>
ReadDiscreteInputs<br>
WriteSingleCoil <br>
WriteMultipleCoils</p>
<p><strong>16 битные функции</strong></p>
<p>ReadInputRegisters <br>
ReadHoldingRegisters <br>
ReadWriteMultipleRegisters<br>
WriteSingleRegister <br>
WriteMultipleRegisters</p>
<hr>
<h3 id=javascript-свойства>javascript свойства</h3>
<ul>
<li>ENTITY_ID</li>
<li>ModbusRtu</li>
<li>entityAction</li>
<li>Action</li>
</ul>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># константа с уникальным id устройства
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>const</span> <span style=color:#000>ENTITY_ID</span>
</code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># выполнение команды(функции) на устройсте:
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>result = </span><span style=color:#000>ModbusRtu</span> <span style=color:#000>func</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>count</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>command</span>
</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>func</td>
<td>функция для выполнения на устройстве</td>
</tr>
<tr>
<td>addr</td>
<td>Адрес первого регистра (40108-40001 = 107 =6B hex)</td>
</tr>
<tr>
<td>count</td>
<td>Количество требуемых регистров (чтение 3-х регистров с 40108 по 40110)</td>
</tr>
<tr>
<td>command</td>
<td>Команда</td>
</tr>
</tbody>
</table>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># функция-обработчик события действий:
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>entityAction = </span><span style=color:#000>(entityId, actionName)-&gt;</span>
</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>entityId</td>
<td>уникальное id устройства</td>
</tr>
<tr>
<td>actionName</td>
<td>системное наименование действия</td>
</tr>
</tbody>
</table>
<div class="alert alert-warning" role=alert>
Объект <strong>Action</strong> доступен в скриптах действий и скриптах закрепленных за устройством.
</div>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>state = </span><span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>new_state: </span><span style=color:#4e9a06>&#39;ENABLED&#39;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#000>attribute_values: </span><span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>heat: </span><span style=color:#204a87;font-weight:700>false</span>
  <span style=color:#000;font-weight:700>},</span>
  <span style=color:#000>settings_value: </span><span style=color:#000;font-weight:700>{},</span>
  <span style=color:#000>storage_save: </span><span style=color:#204a87;font-weight:700>true</span>
<span style=color:#000;font-weight:700>}</span> 
<span style=color:#8f5902;font-style:italic># сохранение состояния 
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Actor</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>setState</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>state</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>new_state</td>
<td>уникальное системное наименование состояния</td>
</tr>
<tr>
<td>attribute_values</td>
<td>значения атрибутов ранее определенных для устройства</td>
</tr>
<tr>
<td>settings_value</td>
<td>значения настроек ранее определенных для устройства</td>
</tr>
<tr>
<td>storage_save</td>
<td>признак записи среза состояния в БД</td>
</tr>
</tbody>
</table>
<hr>
<h3 id=пример-coffeescript-кода>пример coffeescript кода</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># ModbusRtu
</span><span style=color:#8f5902;font-style:italic># ##################################
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#4e9a06>&#34;use strict&#34;</span><span style=color:#000;font-weight:700>;</span>

<span style=color:#000>checkStatus = </span><span style=color:#000>-&gt;</span>
  <span style=color:#000>COMMAND = </span><span style=color:#000;font-weight:700>[]</span>
  <span style=color:#000>FUNC = </span><span style=color:#4e9a06>&#39;ReadHoldingRegisters&#39;</span>
  <span style=color:#000>ADDRESS = </span><span style=color:#0000cf;font-weight:700>0</span>
  <span style=color:#000>COUNT = </span><span style=color:#0000cf;font-weight:700>16</span>
  
  <span style=color:#8f5902;font-style:italic># выполнение команды(функции) на устройсте:
</span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>res = </span><span style=color:#000>ModbusRtu</span> <span style=color:#000>FUNC</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ADDRESS</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>COUNT</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>COMMAND</span>
  <span style=color:#000>print</span> <span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>error</span>
  <span style=color:#000>print</span> <span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>result</span>
  <span style=color:#000>print</span> <span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>time</span>

<span style=color:#8f5902;font-style:italic># функция-обработчик события действий:
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>entityAction = </span><span style=color:#000>(entityId, actionName)-&gt;</span>
  <span style=color:#204a87;font-weight:700>switch</span> <span style=color:#000>actionName</span>
    <span style=color:#204a87;font-weight:700>when</span> <span style=color:#4e9a06>&#39;ON&#39;</span> <span style=color:#204a87;font-weight:700>then</span> <span style=color:#000>doOnAction</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>when</span> <span style=color:#4e9a06>&#39;OFF&#39;</span> <span style=color:#204a87;font-weight:700>then</span> <span style=color:#000>doOffAction</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>when</span> <span style=color:#4e9a06>&#39;CHECK&#39;</span> <span style=color:#204a87;font-weight:700>then</span> <span style=color:#000>checkStatus</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>when</span> <span style=color:#4e9a06>&#39;ON_WITH_ERR&#39;</span> <span style=color:#204a87;font-weight:700>then</span> <span style=color:#000>doOnErrAction</span><span style=color:#000;font-weight:700>()</span>

</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-2ab89625f67635397c493f87afe8c5f2>1.2 - Modbus tcp</h1>
<p>Modbus TCP — для передачи данных через TCP/IP-соединение.</p>
<div class="alert alert-warning" role=alert>
Для работы с modbus rtu устройством требуется настроенная <strong>нода</strong>
</div>
<h3 id=настройка>Настройка:</h3>
<ul>
<li>slave_id <code>1-32</code></li>
<li>address_port <code>localhost:502</code></li>
</ul>
<h3 id=команды>Команды:</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=атрибуты>Атрибуты</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=статус>Статус</h3>
<ul>
<li>произвольный набор</li>
</ul>
<hr>
<h3 id=доступные-функции>Доступные функции</h3>
<p><strong>1 битные функции</strong></p>
<p>ReadCoils <br>
ReadDiscreteInputs<br>
WriteSingleCoil <br>
WriteMultipleCoils</p>
<p><strong>16 битные функции</strong></p>
<p>ReadInputRegisters <br>
ReadHoldingRegisters <br>
ReadWriteMultipleRegisters<br>
WriteSingleRegister <br>
WriteMultipleRegisters</p>
<hr>
<h3 id=javascript-свойства>javascript свойства</h3>
<ul>
<li>ENTITY_ID</li>
<li>ModbusRtu</li>
<li>entityAction</li>
<li>Action</li>
</ul>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># константа с уникальным id устройства
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>const</span> <span style=color:#000>ENTITY_ID</span>
</code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># выполнение команды(функции) на устройсте:
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>result = </span><span style=color:#000>ModbusTcp</span> <span style=color:#000>func</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>count</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>command</span>
</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>func</td>
<td>функция для выполнения на устройстве</td>
</tr>
<tr>
<td>addr</td>
<td>Адрес первого регистра (40108-40001 = 107 =6B hex)</td>
</tr>
<tr>
<td>count</td>
<td>Количество требуемых регистров (чтение 3-х регистров с 40108 по 40110)</td>
</tr>
<tr>
<td>command</td>
<td>Команда</td>
</tr>
</tbody>
</table>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># функция-обработчик события действий:
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>entityAction = </span><span style=color:#000>(entityId, actionName)-&gt;</span>
</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>entityId</td>
<td>уникальное id устройства</td>
</tr>
<tr>
<td>actionName</td>
<td>системное наименование действия</td>
</tr>
</tbody>
</table>
<div class="alert alert-warning" role=alert>
Объект <strong>Action</strong> доступен в скриптах действий и скриптах закрепленных за устройством.
</div>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>state = </span><span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>new_state: </span><span style=color:#4e9a06>&#39;ENABLED&#39;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#000>attribute_values: </span><span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>heat: </span><span style=color:#204a87;font-weight:700>false</span>
  <span style=color:#000;font-weight:700>},</span>
  <span style=color:#000>settings_value: </span><span style=color:#000;font-weight:700>{},</span>
  <span style=color:#000>storage_save: </span><span style=color:#204a87;font-weight:700>true</span>
<span style=color:#000;font-weight:700>}</span> 
<span style=color:#8f5902;font-style:italic># сохранение состояния 
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Actor</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>setState</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>state</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>new_state</td>
<td>уникальное системное наименование состояния</td>
</tr>
<tr>
<td>attribute_values</td>
<td>значения атрибутов ранее определенных для устройства</td>
</tr>
<tr>
<td>settings_value</td>
<td>значения настроек ранее определенных для устройства</td>
</tr>
<tr>
<td>storage_save</td>
<td>признак записи среза состояния в БД</td>
</tr>
</tbody>
</table>
<hr>
<h3 id=пример-coffeescript-кода>пример coffeescript кода</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># ModbusTcp
</span><span style=color:#8f5902;font-style:italic># ##################################
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#4e9a06>&#34;use strict&#34;</span><span style=color:#000;font-weight:700>;</span>

<span style=color:#000>checkStatus = </span><span style=color:#000>-&gt;</span>
  <span style=color:#000>COMMAND = </span><span style=color:#000;font-weight:700>[]</span>
  <span style=color:#000>FUNC = </span><span style=color:#4e9a06>&#39;ReadHoldingRegisters&#39;</span>
  <span style=color:#000>ADDRESS = </span><span style=color:#0000cf;font-weight:700>0</span>
  <span style=color:#000>COUNT = </span><span style=color:#0000cf;font-weight:700>16</span>

  <span style=color:#8f5902;font-style:italic># выполнение команды(функции) на устройсте:
</span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>res = </span><span style=color:#000>ModbusTcp</span> <span style=color:#000>FUNC</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ADDRESS</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>COUNT</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>COMMAND</span>
  <span style=color:#000>print</span> <span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>error</span>
  <span style=color:#000>print</span> <span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>result</span>
  <span style=color:#000>print</span> <span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>time</span>

<span style=color:#8f5902;font-style:italic># функция-обработчик события действий:
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>entityAction = </span><span style=color:#000>(entityId, actionName)-&gt;</span>
  <span style=color:#204a87;font-weight:700>switch</span> <span style=color:#000>actionName</span>
    <span style=color:#204a87;font-weight:700>when</span> <span style=color:#4e9a06>&#39;ON&#39;</span> <span style=color:#204a87;font-weight:700>then</span> <span style=color:#000>doOnAction</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>when</span> <span style=color:#4e9a06>&#39;OFF&#39;</span> <span style=color:#204a87;font-weight:700>then</span> <span style=color:#000>doOffAction</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>when</span> <span style=color:#4e9a06>&#39;CHECK&#39;</span> <span style=color:#204a87;font-weight:700>then</span> <span style=color:#000>checkStatus</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>when</span> <span style=color:#4e9a06>&#39;ON_WITH_ERR&#39;</span> <span style=color:#204a87;font-weight:700>then</span> <span style=color:#000>doOnErrAction</span><span style=color:#000;font-weight:700>()</span>

</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-a1d8fdd29f0690887aa31f7782f9e162>2 - Alexa</h1>
<p>Не законченная статья</p>
<h3 id=настройка>Настройка:</h3>
<h3 id=команды>Команды:</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=атрибуты>Атрибуты</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=статус>Статус</h3>
<ul>
<li>произвольный набор</li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-ef2b94f1a2a793c6662e60a76d3c9154>3 - Cgminer</h1>
<p>Расширение контроля состояния <strong>ASIC</strong> устройств</p>
<p>Доступные бренды:</p>
<ul>
<li>Bitmine Antminer</li>
</ul>
<h3 id=настройка>Настройка:</h3>
<ul>
<li>host</li>
<li>port</li>
<li>timeout</li>
<li>user</li>
<li>pass</li>
<li>manufacturer</li>
<li>model</li>
</ul>
<h3 id=команды>Команды:</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=атрибуты>Атрибуты</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=статус>Статус</h3>
<ul>
<li>произвольный набор</li>
</ul>
</div>
<div class=td-content>
<h1 id=pg-e8459aa132552732476b3a393a8246c7>3.1 - Bitmine</h1>
<p>Работа с устройствами ASIC производителя Bitmine Antminer.</p>
<p>поддерживаемые усторойства:</p>
<ul>
<li>S9</li>
<li>S7</li>
<li>L3</li>
<li>L3</li>
<li>D3</li>
<li>T9</li>
</ul>
<h3 id=javascript-свойства>javascript свойства</h3>
<hr>
<h3 id=miner-базовая-сущность>Miner Базовая сущность</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># константа с уникальным id устройства
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>const</span> <span style=color:#000>ENTITY_ID</span>
</code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>result = </span><span style=color:#000>Miner</span>
    <span style=color:#000;font-weight:700>.</span><span style=color:#000>stats</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#000;font-weight:700>.</span><span style=color:#000>devs</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#000;font-weight:700>.</span><span style=color:#000>summary</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#000;font-weight:700>.</span><span style=color:#000>pools</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#000;font-weight:700>.</span><span style=color:#000>addPool</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>url</span> <span style=color:#000>string</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>.</span><span style=color:#000>version</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#000;font-weight:700>.</span><span style=color:#000>enable</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>poolId</span> <span style=color:#000>int64</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>.</span><span style=color:#000>disable</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>poolId</span> <span style=color:#000>int64</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>.</span><span style=color:#000>delete</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>poolId</span> <span style=color:#000>int64</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>.</span><span style=color:#000>switchPool</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>poolId</span> <span style=color:#000>int64</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000;font-weight:700>.</span><span style=color:#000>restart</span><span style=color:#000;font-weight:700>()</span>
</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>result</td>
<td>type: Object (Result)</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>stats</td>
<td>type: метод, статистика</td>
</tr>
<tr>
<td>devs</td>
<td>type: метод, статистика</td>
</tr>
<tr>
<td>summary</td>
<td>type: метод, статистика</td>
</tr>
<tr>
<td>pools</td>
<td>type: метод, список серверов</td>
</tr>
<tr>
<td>addPool</td>
<td>type: метод, добавление сервера</td>
</tr>
<tr>
<td>version</td>
<td>type: метод, версия прошивки</td>
</tr>
<tr>
<td>enable</td>
<td>type: метод, включение в работу сервера</td>
</tr>
<tr>
<td>disable</td>
<td>type: метод, включение сервера</td>
</tr>
<tr>
<td>delete</td>
<td>type: метод, удаление сервера</td>
</tr>
<tr>
<td>switchPool</td>
<td>type: метод, переключние сервера</td>
</tr>
<tr>
<td>restart</td>
<td>type: метод, мягкий перезапуск устройства</td>
</tr>
</tbody>
</table>
<hr>
<h3 id=объект-result>объект Result</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript>  <span style=color:#000>result = </span><span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>error: </span><span style=color:#204a87;font-weight:700>false</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#000>errMessage: </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#000>result: </span><span style=color:#4e9a06>&#34;&#34;</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>error</td>
<td>type: boolean, признак ошибки</td>
</tr>
<tr>
<td>errMessage</td>
<td>type: string, человекопонятное описание ошибки</td>
</tr>
<tr>
<td>result</td>
<td>type: string, json объект в текстовом формате, если запрос завершился без ошибок</td>
</tr>
</tbody>
</table>
<hr>
<h3 id=функция-entityaction>функция entityAction</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>entityAction = </span><span style=color:#000>(entityId, actionName)-&gt;</span>
</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>entityId</td>
<td>type: string, id сущности отправляющего сообщение</td>
</tr>
<tr>
<td>actionName</td>
<td>type: string, название действия, без символа &lsquo;/&rsquo; в верхнем регистре</td>
</tr>
</tbody>
</table>
<hr>
<h3 id=обект-actor>Обект Actor</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>Actor</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>setState</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>entityStateParams</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>setState</td>
<td>type: метод, обновление статуса сущности</td>
</tr>
<tr>
<td>entityStateParams</td>
<td>type: Object EntityStateParams</td>
</tr>
</tbody>
</table>
<hr>
<h3 id=объект-entitystateparams>объект EntityStateParams</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript>  <span style=color:#000>entityStateParams = </span><span style=color:#000;font-weight:700>{</span>
    <span style=color:#4e9a06>&#34;new_state&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;&#34;</span>
    <span style=color:#4e9a06>&#34;attribute_values&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000;font-weight:700>{}</span>
    <span style=color:#4e9a06>&#34;settings_value&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000;font-weight:700>{}</span>
    <span style=color:#4e9a06>&#34;storage_save&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>true</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>new_state</td>
<td>type: *string, наименование статуса</td>
</tr>
<tr>
<td>attribute_values</td>
<td>type: Object, новое состяние аттрибутов сущности</td>
</tr>
<tr>
<td>settings_value</td>
<td>type: Object, новое состояние настроек сущности</td>
</tr>
<tr>
<td>storage_save</td>
<td>type: boolean, признак записи нового состояния в бд</td>
</tr>
</tbody>
</table>
<hr>
<h3 id=пример-кода>пример кода</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># cgminer
</span><span style=color:#8f5902;font-style:italic># ##################################
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#000>ifError</span> <span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>(res)-&gt;</span>
  <span style=color:#204a87;font-weight:700>return</span> <span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>res</span> <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>error</span> <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#204a87>Error</span>

<span style=color:#000>checkStatus</span> <span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>-&gt;</span>
  <span style=color:#000>stats = </span><span style=color:#000>Miner</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>stats</span><span style=color:#000;font-weight:700>()</span>
  <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>ifError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>stats</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000>Actor</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>setState</span>
      <span style=color:#4e9a06>&#39;new_state&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;ERROR&#39;</span>
    <span style=color:#204a87;font-weight:700>return</span>
  <span style=color:#000>p = </span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>parse</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>stats</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>result</span><span style=color:#000;font-weight:700>)</span>
  <span style=color:#000>print</span> <span style=color:#000>p</span>

<span style=color:#000>checkSum</span> <span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>-&gt;</span>
  <span style=color:#000>summary = </span><span style=color:#000>Miner</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>summary</span><span style=color:#000;font-weight:700>()</span>
  <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>ifError</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>summary</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000>Actor</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>setState</span>
      <span style=color:#4e9a06>&#39;new_state&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;ERROR&#39;</span>
    <span style=color:#204a87;font-weight:700>return</span>
  <span style=color:#000>p = </span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>parse</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>summary</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>result</span><span style=color:#000;font-weight:700>)</span>
  <span style=color:#000>print</span> <span style=color:#000>p</span>

<span style=color:#000>entityAction = </span><span style=color:#000>(entityId, actionName)-&gt;</span>
  <span style=color:#204a87;font-weight:700>switch</span> <span style=color:#000>actionName</span>
    <span style=color:#204a87;font-weight:700>when</span> <span style=color:#4e9a06>&#39;CHECK&#39;</span> <span style=color:#204a87;font-weight:700>then</span> <span style=color:#000>checkStatus</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>when</span> <span style=color:#4e9a06>&#39;SUM&#39;</span> <span style=color:#204a87;font-weight:700>then</span> <span style=color:#000>checkSum</span><span style=color:#000;font-weight:700>()</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-b9c377ed5c1bd68dd431e00f16e09761>4 - Node</h1>
<p>Не законченная статья</p>
<h3 id=настройка>Настройка:</h3>
<h3 id=команды>Команды:</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=атрибуты>Атрибуты</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=статус>Статус</h3>
<ul>
<li>произвольный набор</li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-25150d443099ad5064f1a3a39214945d>5 - Отправка сообщений</h1>
<p>Базовое расширение для обеспечения уведомлений, таких как <em>sms</em>, <em>push</em>, <em>email</em>, <em>telegram</em>, etc.</p>
<h3 id=javascript-свойства>javascript свойства</h3>
<hr>
<h3 id=новое-сообщение>Новое сообщение</h3>
<p>создает объект сообщения</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript>  <span style=color:#000>msg = </span><span style=color:#000>notifr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>newMessage</span><span style=color:#000;font-weight:700>();</span>
</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>newMessage()</td>
<td>метод</td>
</tr>
<tr>
<td>msg</td>
<td>type: Object <a href=#%D0%BE%D0%B1%D1%8A%D0%B5%D0%BA%D1%82-message>Message</a></td>
</tr>
</tbody>
</table>
<hr>
<h3 id=отправка-сообщения>отправка сообщения</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript>  <span style=color:#000>notifr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>send</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>msg</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>send()</td>
<td>метод</td>
</tr>
<tr>
<td>msg</td>
<td>type: Object (Message)</td>
</tr>
</tbody>
</table>
<h3 id=объект-message>объект Message</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript>  <span style=color:#000>message = </span><span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>from: </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#000>type: </span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#000>attributes: </span><span style=color:#000;font-weight:700>{</span>
    <span style=color:#4e9a06>&#34;key&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;vlue&#34;</span>
  <span style=color:#000;font-weight:700>}</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>from</td>
<td>type: string</td>
</tr>
<tr>
<td>type</td>
<td>type: string</td>
</tr>
<tr>
<td>attributes</td>
<td>type: map[string]string</td>
</tr>
</tbody>
</table>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-ffcf992bf86dcf75fc98ea391689be36>5.1 - Messagebird</h1>
<p>Отправка sms уведомлений через провайдера услуг оповещения <a href=https://messagebird.com>messagebird</a>. Для возможности
отправки сообщений потребуется регистрация в <a href=https://messagebird.com>messagebird</a>, и положительный баланс.</p>
<h3 id=настройка>Настройка</h3>
<ul>
<li>Access Key</li>
<li>Name</li>
</ul>
<h3 id=атрибуты>Атрибуты</h3>
<ul>
<li>Payment</li>
<li>Type</li>
<li>Amount</li>
</ul>
<h3 id=javascript-свойства>javascript свойства</h3>
<hr>
<h3 id=новое-сообщение>Новое сообщение</h3>
<p>создает объект сообщения</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>msg = </span><span style=color:#000>notifr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>newMessage</span><span style=color:#000;font-weight:700>();</span>
<span style=color:#000>msg.type = </span><span style=color:#4e9a06>&#39;messagebird&#39;</span><span style=color:#000;font-weight:700>;</span>
<span style=color:#000>msg.attributes = </span><span style=color:#000;font-weight:700>{</span>
  <span style=color:#4e9a06>&#39;phone&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;+79990000001&#39;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#4e9a06>&#39;body&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;some text&#39;</span>
<span style=color:#000;font-weight:700>};</span>

</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>newMessage()</td>
<td>метод</td>
</tr>
<tr>
<td>msg</td>
<td>type: Object (Message)</td>
</tr>
</tbody>
</table>
<hr>
<h3 id=пример-кода>пример кода</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># messagebird
</span><span style=color:#8f5902;font-style:italic># ##################################
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#000>sendMsg</span> <span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>(body)-&gt;</span>
  <span style=color:#000>msg = </span><span style=color:#000>notifr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>newMessage</span><span style=color:#000;font-weight:700>();</span>
  <span style=color:#000>msg.type = </span><span style=color:#4e9a06>&#39;messagebird&#39;</span><span style=color:#000;font-weight:700>;</span>
  <span style=color:#000>msg.attributes = </span><span style=color:#000;font-weight:700>{</span>
    <span style=color:#4e9a06>&#39;phone&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;+79990000001&#39;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#4e9a06>&#39;body&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;some text&#39;</span>
  <span style=color:#000;font-weight:700>};</span>
  <span style=color:#000>notifr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>send</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>msg</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-ae8769291a804111fe0f11577b37bb14>5.2 - Slack</h1>
<p>Отправка уведомлений в чат slack</p>
<h3 id=настройка>Настройка</h3>
<ul>
<li>Token</li>
<li>User name</li>
</ul>
<h3 id=javascript-свойства>javascript свойства</h3>
<hr>
<h3 id=новое-сообщение>Новое сообщение</h3>
<p>создает объект сообщения</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>msg = </span><span style=color:#000>notifr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>newMessage</span><span style=color:#000;font-weight:700>();</span>
<span style=color:#000>msg.type = </span><span style=color:#4e9a06>&#39;slack&#39;</span><span style=color:#000;font-weight:700>;</span>
<span style=color:#000>msg.attributes = </span><span style=color:#000;font-weight:700>{</span>
  <span style=color:#4e9a06>&#39;channel&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;#ch&#39;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#4e9a06>&#39;text&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;some text&#39;</span>
<span style=color:#000;font-weight:700>};</span>

</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>newMessage()</td>
<td>метод</td>
</tr>
<tr>
<td>msg</td>
<td>type: Object (Message)</td>
</tr>
</tbody>
</table>
<hr>
<h3 id=пример-кода>пример кода</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># slack
</span><span style=color:#8f5902;font-style:italic># ##################################
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#000>sendMsg</span> <span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>(body)-&gt;</span>
  <span style=color:#000>msg = </span><span style=color:#000>notifr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>newMessage</span><span style=color:#000;font-weight:700>();</span>
    <span style=color:#000>msg.type = </span><span style=color:#4e9a06>&#39;slack&#39;</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000>msg.attributes = </span><span style=color:#000;font-weight:700>{</span>
      <span style=color:#4e9a06>&#39;channel&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;#ch&#39;</span><span style=color:#000;font-weight:700>,</span>
      <span style=color:#4e9a06>&#39;text&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;some text&#39;</span>
  <span style=color:#000;font-weight:700>};</span>
  <span style=color:#000>notifr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>send</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>msg</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-3474b889257fbfc72d90e2b2883e468a>5.3 - Telegram</h1>
<p>Позволяет работать с telegram api, обеспечивая интерактивную обработку комманд от клиентов либо использовать
событийное оповещение. Система не имеет ограничение на количество ботов, один entity - один бот.</p>
<h3 id=настройка>Настройка</h3>
<ul>
<li>Token</li>
</ul>
<h3 id=команды>Команды:</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=атрибуты>Атрибуты</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=действия>Действия</h3>
<p>В системе зарезервированно три команды:</p>
<ul>
<li><strong>/start</strong> - подписаться на уведомления</li>
<li><strong>/quit</strong> - отписаться от уведомлений</li>
<li><strong>/help</strong> - вывод доступных команд</li>
</ul>
<p><strong>Action</strong> (действие) - должно наименоваться в нижнем регистре, без знаков &ldquo;/&rdquo;.
Кастомная команда в системе автоматически добавится в список доступных команд раздела <strong>/help</strong>.
Вызов кастомной команды с клиента следует производить в верхнем регистре <strong>/ACTION</strong> -> <strong>/action</strong></p>
<h3 id=javascript-свойства>javascript свойства</h3>
<hr>
<h3 id=новое-сообщение>Новое сообщение</h3>
<p>создает объект сообщения</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>msg = </span><span style=color:#000>notifr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>newMessage</span><span style=color:#000;font-weight:700>();</span>
<span style=color:#000>msg.type = </span><span style=color:#4e9a06>&#39;telegram&#39;</span><span style=color:#000;font-weight:700>;</span>
<span style=color:#000>msg.attributes = </span><span style=color:#000;font-weight:700>{</span>
  <span style=color:#4e9a06>&#39;name&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;clavicus&#39;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#4e9a06>&#39;body&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;some text msg&#39;</span>
<span style=color:#000;font-weight:700>};</span>

</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>newMessage()</td>
<td>метод</td>
</tr>
<tr>
<td>msg</td>
<td>type: Object (Message)</td>
</tr>
</tbody>
</table>
<hr>
<h3 id=функция-telegramaction>функция telegramAction</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>telegramAction = </span><span style=color:#000>(entityId, actionName)-&gt;</span>
</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>entityId</td>
<td>type: string, id сущности отправляющего сообщение</td>
</tr>
<tr>
<td>actionName</td>
<td>type: string, название действия, без символа &lsquo;/&rsquo; в верхнем регистре</td>
</tr>
</tbody>
</table>
<h3 id=пример-кода>пример кода</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># telegram
</span><span style=color:#8f5902;font-style:italic># ##################################
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>telegramSendReport</span> <span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>-&gt;</span>
  <span style=color:#000>entities = </span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;device.l3n1&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#39;device.l3n2&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#39;device.l3n3&#39;</span><span style=color:#000;font-weight:700>,</span><span style=color:#4e9a06>&#39;device.l3n4&#39;</span><span style=color:#000;font-weight:700>]</span>
  <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000>entityId</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>i</span> <span style=color:#204a87;font-weight:700>in</span> <span style=color:#000>entities</span>
    <span style=color:#000>entity = </span><span style=color:#000>entityManager</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>getEntity</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>entityId</span><span style=color:#000;font-weight:700>)</span>
    <span style=color:#000>attr = </span><span style=color:#000>entity</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>getAttributes</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#000>sendMsg</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>format</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>entityId</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>entity</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>state</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>name</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>attr</span><span style=color:#000;font-weight:700>))</span>
  
<span style=color:#000>telegramAction = </span><span style=color:#000>(entityId, actionName)-&gt;</span>
<span style=color:#204a87;font-weight:700>switch</span> <span style=color:#000>actionName</span>
    <span style=color:#204a87;font-weight:700>when</span> <span style=color:#4e9a06>&#39;CHECK&#39;</span> <span style=color:#204a87;font-weight:700>then</span> <span style=color:#000>telegramSendReport</span><span style=color:#000;font-weight:700>()</span>

<span style=color:#000>sendMsg</span> <span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>(body)-&gt;</span>
  <span style=color:#000>msg = </span><span style=color:#000>notifr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>newMessage</span><span style=color:#000;font-weight:700>();</span>
  <span style=color:#000>msg.type = </span><span style=color:#4e9a06>&#39;telegram&#39;</span><span style=color:#000;font-weight:700>;</span>
  <span style=color:#000>msg.attributes = </span><span style=color:#000;font-weight:700>{</span>
    <span style=color:#4e9a06>&#39;name&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;clavicus&#39;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#4e9a06>&#39;body&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>body</span>
  <span style=color:#000;font-weight:700>};</span>
  <span style=color:#000>notifr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>send</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>msg</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-8d473157f65e8e52157febb9c1671a23>5.4 - Twilio</h1>
<p>Отправка sms уведомлений через провайдера услуг оповещения <a href=https://www.twilio.com/messaging>twilio</a>. Для возможности
отправки сообщений потребуется регистрация в <a href=https://www.twilio.com/messaging>twilio</a>, и положительный баланс.</p>
<h3 id=настройка>Настройка</h3>
<ul>
<li>Token</li>
<li>Sid</li>
<li>From</li>
</ul>
<h3 id=атрибуты>Атрибуты</h3>
<ul>
<li>Amount</li>
<li>Sid</li>
<li>Currency</li>
</ul>
<h3 id=javascript-свойства>javascript свойства</h3>
<hr>
<h3 id=новое-сообщение>Новое сообщение</h3>
<p>создает объект сообщения</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>msg = </span><span style=color:#000>notifr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>newMessage</span><span style=color:#000;font-weight:700>();</span>
<span style=color:#000>msg.type = </span><span style=color:#4e9a06>&#39;twilio&#39;</span><span style=color:#000;font-weight:700>;</span>
<span style=color:#000>msg.attributes = </span><span style=color:#000;font-weight:700>{</span>
  <span style=color:#4e9a06>&#39;phone&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;+79990000001&#39;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#4e9a06>&#39;body&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;some text&#39;</span>
<span style=color:#000;font-weight:700>};</span>

</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>newMessage()</td>
<td>метод</td>
</tr>
<tr>
<td>msg</td>
<td>type: Object (Message)</td>
</tr>
</tbody>
</table>
<hr>
<h3 id=пример-кода>пример кода</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># twilio
</span><span style=color:#8f5902;font-style:italic># ##################################
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#000>sendMsg</span> <span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>(body)-&gt;</span>
  <span style=color:#000>msg = </span><span style=color:#000>notifr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>newMessage</span><span style=color:#000;font-weight:700>();</span>
  <span style=color:#000>msg.type = </span><span style=color:#4e9a06>&#39;twilio&#39;</span><span style=color:#000;font-weight:700>;</span>
  <span style=color:#000>msg.attributes = </span><span style=color:#000;font-weight:700>{</span>
    <span style=color:#4e9a06>&#39;phone&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;+79990000001&#39;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#4e9a06>&#39;body&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;some text&#39;</span>
  <span style=color:#000;font-weight:700>};</span>
  <span style=color:#000>notifr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>send</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>msg</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-56027f5b7f86e356eca9778287b4e9b7>5.5 - Шаблон сообщения</h1>
<p><strong>Template</strong> (Шаблон) - инструмент для заполнения и рассылки готовых сообщений.</p>
<p>преимущества:</p>
<ul>
<li>чистый код</li>
<li>разные шаблоны для разных типов</li>
<li>удобный вызов</li>
</ul>
<h3 id=javascript-свойства>javascript свойства</h3>
<hr>
<h3 id=генерация-сообщения-из-шаблона>Генерация сообщения из шаблона</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript>  <span style=color:#000>tpl = </span><span style=color:#000>template</span>
    <span style=color:#000;font-weight:700>.</span><span style=color:#000>render</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>params</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>type: string, название шаблона</td>
</tr>
<tr>
<td>params</td>
<td>type: Object, параметры шаблона, пример: {&lsquo;key&rsquo;:&lsquo;val&rsquo;}</td>
</tr>
<tr>
<td>tpl</td>
<td>type: string, сгенерированное сообщение, готовое к отправке</td>
</tr>
</tbody>
</table>
<h3 id=пример-кода>пример кода</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># telegram
</span><span style=color:#8f5902;font-style:italic># ##################################
</span><span style=color:#8f5902;font-style:italic></span>

<span style=color:#000>sendMsg</span> <span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>(body)-&gt;</span>
  <span style=color:#000>tpl = </span><span style=color:#000>template</span>
    <span style=color:#000;font-weight:700>.</span><span style=color:#000>render</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;name&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#39;key&#39;</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#4e9a06>&#39;val&#39;</span><span style=color:#000;font-weight:700>})</span>
  
  <span style=color:#000>msg = </span><span style=color:#000>notifr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>newMessage</span><span style=color:#000;font-weight:700>();</span>
  <span style=color:#000>msg.type = </span><span style=color:#4e9a06>&#39;telegram&#39;</span><span style=color:#000;font-weight:700>;</span>
  <span style=color:#000>msg.attributes = </span><span style=color:#000;font-weight:700>{</span>
    <span style=color:#4e9a06>&#39;name&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;clavicus&#39;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#4e9a06>&#39;body&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>tpl</span>
  <span style=color:#000;font-weight:700>};</span>
  <span style=color:#000>notifr</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>send</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>msg</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-8b799860c72c486736100d02c3b203e3>6 - Scene</h1>
<p>Не законченная статья</p>
<h3 id=настройка>Настройка:</h3>
<h3 id=команды>Команды:</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=атрибуты>Атрибуты</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=статус>Статус</h3>
<ul>
<li>произвольный набор</li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-86ac7251d4f2a101f1d1d81f108814d2>7 - Script</h1>
<p>Не законченная статья</p>
<h3 id=настройка>Настройка:</h3>
<h3 id=команды>Команды:</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=атрибуты>Атрибуты</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=статус>Статус</h3>
<ul>
<li>произвольный набор</li>
</ul>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-066d57f2c4c1d00c7083fef19e2b62f3>8 - Sensor</h1>
<p>Не законченная статья</p>
<h3 id=настройка>Настройка:</h3>
<h3 id=команды>Команды:</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=атрибуты>Атрибуты</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=статус>Статус</h3>
<ul>
<li>произвольный набор</li>
</ul>
</div>
</main>
</div>
</div>
<footer class="bg-dark py-5 row d-print-none">
<div class="container-fluid mx-sm-5">
<div class=row>
<div class="col-6 col-sm-4 text-xs-center order-sm-2">
</div>
<div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub>
<a class=text-white target=_blank rel=noopener href=https://github.com/e154/smart-home aria-label=GitHub>
<i class="fab fa-github"></i>
</a>
</li>
</ul>
</div>
<div class="col-12 col-sm-4 text-center py-2 order-sm-2">
<small class=text-white>&copy; 2021 Разработано при поддержке <a href=http://e154.ru>e154.ru</a></small>
<div><small class="ml-1 text-white">Код лицензии <a href=https://github.com/e154/smart-home/blob/master/LICENSE>MIT</a> документы <a href=http://creativecommons.org/licenses/by/3.0/>CC BY 3.0</a></small></div>
</div>
</div>
</div>
</footer>
</div>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script>
<script src=/smart-home/js/tabpane-persist.js></script>
<script src=/smart-home/js/main.min.307d9740a83ff885dafd50af6ce4f79e2146b78e74ee078b11b627d0d02146a9.js integrity="sha256-MH2XQKg/+IXa/VCvbOT3niFGt4507geLEbYn0NAhRqk=" crossorigin=anonymous></script>
</body>
</html>