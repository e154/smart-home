<!doctype html><html lang=ru class=no-js>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=generator content="Hugo 0.89.4"><meta name=ROBOTS content="INDEX, FOLLOW">
<link rel="shortcut icon" href=/smart-home/favicons/favicon.ico>
<link rel=apple-touch-icon href=/smart-home/favicons/apple-touch-icon-180x180.png sizes=180x180>
<link rel=icon type=image/png href=/smart-home/favicons/favicon-16x16.png sizes=16x16>
<link rel=icon type=image/png href=/smart-home/favicons/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/smart-home/favicons/android-36x36.png sizes=36x36>
<link rel=icon type=image/png href=/smart-home/favicons/android-48x48.png sizes=48x48>
<link rel=icon type=image/png href=/smart-home/favicons/android-72x72.png sizes=72x72>
<link rel=icon type=image/png href=/smart-home/favicons/android-96x96.png sizes=96x96>
<link rel=icon type=image/png href=/smart-home/favicons/android-144x144.png sizes=144x144>
<link rel=icon type=image/png href=/smart-home/favicons/android-192x192.png sizes=192x192>
<title>Modbus rtu | Умный дом</title>
<meta name=description content="Modbus RTU — компактный двоичный вариант. Сообщения разделяются по паузе в линии. Сообщение должно начинаться и
заканчиваться интервалом тишины, …">
<meta property="og:title" content="Modbus rtu">
<meta property="og:description" content="Modbus RTU — компактный двоичный вариант. Сообщения разделяются по паузе в линии. Сообщение должно начинаться и заканчиваться интервалом тишины, длительностью не менее 3,5 символов при данной скорости передачи. Во время передачи сообщения не должно быть пауз длительностью более 1,5 символов. Для скоростей более 19200 бод допускается использовать интервалы 1,75 и 0,75 мс, соответственно. Проверка целостности осуществляется с помощью CRC.
Для работы с modbus rtu устройством требуется настроенная нода  Настройка:  slave_id 1-32 baud 9600, 19200 data_bits 5-9 timeout milliseconds stop_bits 1-2 sleep milliseconds parity none, odd, even  Команды:  произвольный набор  Атрибуты  произвольный набор  Статус  произвольный набор   Доступные функции 1 битные функции">
<meta property="og:type" content="article">
<meta property="og:url" content="https://e154.github.io/smart-home/docs/plugins/modbus/modbus_rtu/"><meta property="article:section" content="docs">
<meta property="article:published_time" content="2021-10-20T00:00:00+00:00">
<meta property="article:modified_time" content="2022-01-21T14:28:33+07:00"><meta property="og:site_name" content="Умный дом">
<meta itemprop=name content="Modbus rtu">
<meta itemprop=description content="Modbus RTU — компактный двоичный вариант. Сообщения разделяются по паузе в линии. Сообщение должно начинаться и заканчиваться интервалом тишины, длительностью не менее 3,5 символов при данной скорости передачи. Во время передачи сообщения не должно быть пауз длительностью более 1,5 символов. Для скоростей более 19200 бод допускается использовать интервалы 1,75 и 0,75 мс, соответственно. Проверка целостности осуществляется с помощью CRC.
Для работы с modbus rtu устройством требуется настроенная нода  Настройка:  slave_id 1-32 baud 9600, 19200 data_bits 5-9 timeout milliseconds stop_bits 1-2 sleep milliseconds parity none, odd, even  Команды:  произвольный набор  Атрибуты  произвольный набор  Статус  произвольный набор   Доступные функции 1 битные функции"><meta itemprop=datePublished content="2021-10-20T00:00:00+00:00">
<meta itemprop=dateModified content="2022-01-21T14:28:33+07:00">
<meta itemprop=wordCount content="312">
<meta itemprop=keywords content><meta name=twitter:card content="summary">
<meta name=twitter:title content="Modbus rtu">
<meta name=twitter:description content="Modbus RTU — компактный двоичный вариант. Сообщения разделяются по паузе в линии. Сообщение должно начинаться и заканчиваться интервалом тишины, длительностью не менее 3,5 символов при данной скорости передачи. Во время передачи сообщения не должно быть пауз длительностью более 1,5 символов. Для скоростей более 19200 бод допускается использовать интервалы 1,75 и 0,75 мс, соответственно. Проверка целостности осуществляется с помощью CRC.
Для работы с modbus rtu устройством требуется настроенная нода  Настройка:  slave_id 1-32 baud 9600, 19200 data_bits 5-9 timeout milliseconds stop_bits 1-2 sleep milliseconds parity none, odd, even  Команды:  произвольный набор  Атрибуты  произвольный набор  Статус  произвольный набор   Доступные функции 1 битные функции">
<link rel=preload href=/smart-home/scss/main.min.bd5285b713d3061549a6bfd34e5f4ec6775ede36672a3088260f0d420050647f.css as=style>
<link href=/smart-home/scss/main.min.bd5285b713d3061549a6bfd34e5f4ec6775ede36672a3088260f0d420050647f.css rel=stylesheet integrity>
<script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
</head>
<body class=td-page>
<header>
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
<a class=navbar-brand href=/smart-home/>
<span class=navbar-logo></span><span class="text-uppercase font-weight-bold">Умный дом</span>
</a>
<div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar>
<ul class="navbar-nav mt-2 mt-lg-0">
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class="nav-link active" href=/smart-home/docs/><span class=active>Документация</span></a>
</li>
<li class="nav-item dropdown mr-4 d-none d-lg-block">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
Русский
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=/smart-home/en/>English</a>
</div>
</li>
</ul>
</div>
<div class="navbar-nav d-none d-lg-block">
</div>
</nav>
</header>
<div class="container-fluid td-outer">
<div class=td-main>
<div class="row flex-xl-nowrap">
<aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
<div id=td-sidebar-menu class=td-sidebar__inner>
<form class="td-sidebar__search d-flex align-items-center">
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation">
</button>
</form>
<nav class="collapse td-sidebar-nav" id=td-section-nav>
<div class="nav-item dropdown d-block d-lg-none">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
Русский
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=/smart-home/en/>English</a>
</div>
</div>
<ul class="td-sidebar-nav__section pr-md-3 ul-0">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-smart-homedocs-li>
<a href=/smart-home/docs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-smart-homedocs><span>Документация</span></a>
<ul class=ul-1>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-smart-homedocsjavascript-li>
<a href=/smart-home/docs/javascript/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-smart-homedocsjavascript><span>Javascript</span></a>
<ul class="ul-2 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-smart-homedocsjavascriptentity_manager-li>
<a href=/smart-home/docs/javascript/entity_manager/ title="Менеджер устройств" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-smart-homedocsjavascriptentity_manager><span>entity manager</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-smart-homedocsjavascriptmqtt-li>
<a href=/smart-home/docs/javascript/mqtt/ title=Mqtt class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-smart-homedocsjavascriptmqtt><span>mqtt</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-smart-homedocsjavascriptexecute-li>
<a href=/smart-home/docs/javascript/execute/ title="Выполнение системных команд" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-smart-homedocsjavascriptexecute><span>execute</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-smart-homedocsjavascriptlog-li>
<a href=/smart-home/docs/javascript/log/ title=Логирование class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-smart-homedocsjavascriptlog><span>log</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-smart-homedocsjavascriptstorage-li>
<a href=/smart-home/docs/javascript/storage/ title="Временное хранилище" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-smart-homedocsjavascriptstorage><span>storage</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-smart-homedocsjavascripthttp-li>
<a href=/smart-home/docs/javascript/http/ title="http запросы" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-smart-homedocsjavascripthttp><span>http</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-smart-homedocsplugins-li>
<a href=/smart-home/docs/plugins/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-smart-homedocsplugins><span>Расширения</span></a>
<ul class="ul-2 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-smart-homedocspluginsmodbus-li>
<a href=/smart-home/docs/plugins/modbus/ title=Modbus class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-smart-homedocspluginsmodbus><span>modbus</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-smart-homedocspluginsmodbusmodbus_rtu-li>
<a href=/smart-home/docs/plugins/modbus/modbus_rtu/ title="Modbus rtu" class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-smart-homedocspluginsmodbusmodbus_rtu><span class=td-sidebar-nav-active-item>modbus rtu</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-smart-homedocspluginsmodbusmodbus_tcp-li>
<a href=/smart-home/docs/plugins/modbus/modbus_tcp/ title="Modbus tcp" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-smart-homedocspluginsmodbusmodbus_tcp><span>modbus tcp</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-smart-homedocspluginsalexa-li>
<a href=/smart-home/docs/plugins/alexa/ title=Alexa class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-smart-homedocspluginsalexa><span>alexa</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-smart-homedocspluginscgminer-li>
<a href=/smart-home/docs/plugins/cgminer/ title=Cgminer class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-smart-homedocspluginscgminer><span>cgminer</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-smart-homedocspluginscgminerbitmine-li>
<a href=/smart-home/docs/plugins/cgminer/bitmine/ title=Bitmine class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-smart-homedocspluginscgminerbitmine><span>bitmine</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-smart-homedocspluginsnode-li>
<a href=/smart-home/docs/plugins/node/ title=Node class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-smart-homedocspluginsnode><span>node</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-smart-homedocspluginsnotify-li>
<a href=/smart-home/docs/plugins/notify/ title="Отправка сообщений" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-smart-homedocspluginsnotify><span>notify</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-smart-homedocspluginsnotifymessagebird-li>
<a href=/smart-home/docs/plugins/notify/messagebird/ title=Messagebird class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-smart-homedocspluginsnotifymessagebird><span>messagebird</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-smart-homedocspluginsnotifyslack-li>
<a href=/smart-home/docs/plugins/notify/slack/ title=Slack class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-smart-homedocspluginsnotifyslack><span>slack</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-smart-homedocspluginsnotifytelegram-li>
<a href=/smart-home/docs/plugins/notify/telegram/ title=Telegram class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-smart-homedocspluginsnotifytelegram><span>telegram</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-smart-homedocspluginsnotifytwilio-li>
<a href=/smart-home/docs/plugins/notify/twilio/ title=Twilio class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-smart-homedocspluginsnotifytwilio><span>twilio</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-smart-homedocspluginsnotifytemplate-li>
<a href=/smart-home/docs/plugins/notify/template/ title="Шаблон сообщения" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-smart-homedocspluginsnotifytemplate><span>шаблоны</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-smart-homedocspluginsscene-li>
<a href=/smart-home/docs/plugins/scene/ title=Scene class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-smart-homedocspluginsscene><span>scene</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-smart-homedocspluginsscript-li>
<a href=/smart-home/docs/plugins/script/ title=Script class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-smart-homedocspluginsscript><span>script</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-smart-homedocspluginssensor-li>
<a href=/smart-home/docs/plugins/sensor/ title=Sensor class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-smart-homedocspluginssensor><span>sensor</span></a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</aside>
<aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
<a href=https://github.com/e154/smart-home/edit/master/content/ru/docs/plugins/modbus/modbus_rtu.md target=_blank><i class="fa fa-edit fa-fw"></i> Отредактировать страницу</a>
<a href="https://github.com/e154/smart-home/new/master/content/ru/docs/plugins/modbus/modbus_rtu.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" target=_blank><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/e154/smart-home/issues/new?title=Modbus%20rtu" target=_blank><i class="fab fa-github fa-fw"></i> Предложить изменения документации</a>
<a href=https://github.com/e154/smart-home/issues/new target=_blank><i class="fas fa-tasks fa-fw"></i> Предложить доработки по проекту</a>
<a id=print href=https://e154.github.io/smart-home/docs/plugins/modbus/_print/><i class="fa fa-print fa-fw"></i> Print entire section</a>
</div>
<div class=td-toc><nav id=TableOfContents>
<ul>
<li>
<ul>
<li><a href=#настройка>Настройка:</a></li>
<li><a href=#команды>Команды:</a></li>
<li><a href=#атрибуты>Атрибуты</a></li>
<li><a href=#статус>Статус</a></li>
<li><a href=#доступные-функции>Доступные функции</a></li>
<li><a href=#javascript-свойства>javascript свойства</a></li>
<li><a href=#пример-coffeescript-кода>пример coffeescript кода</a></li>
</ul>
</li>
</ul>
</nav></div>
</aside>
<main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main>
<nav aria-label=breadcrumb class="d-none d-md-block d-print-none">
<ol class="breadcrumb spb-1">
<li class=breadcrumb-item>
<a href=https://e154.github.io/smart-home/docs/>Документация</a>
</li>
<li class=breadcrumb-item>
<a href=https://e154.github.io/smart-home/docs/plugins/>Расширения</a>
</li>
<li class=breadcrumb-item>
<a href=https://e154.github.io/smart-home/docs/plugins/modbus/>modbus</a>
</li>
<li class="breadcrumb-item active" aria-current=page>
<a href=https://e154.github.io/smart-home/docs/plugins/modbus/modbus_rtu/>modbus rtu</a>
</li>
</ol>
</nav>
<div class=td-content>
<h1>Modbus rtu</h1>
<header class=article-meta>
</header>
<p>Modbus RTU — компактный двоичный вариант. Сообщения разделяются по паузе в линии. Сообщение должно начинаться и
заканчиваться интервалом тишины, длительностью не менее 3,5 символов при данной скорости передачи. Во время передачи
сообщения не должно быть пауз длительностью более 1,5 символов. Для скоростей более 19200 бод допускается использовать
интервалы 1,75 и 0,75 мс, соответственно. Проверка целостности осуществляется с помощью CRC.</p>
<div class="alert alert-warning" role=alert>
Для работы с modbus rtu устройством требуется настроенная <strong>нода</strong>
</div>
<h3 id=настройка>Настройка:</h3>
<ul>
<li>slave_id <code>1-32</code></li>
<li>baud <code>9600, 19200</code></li>
<li>data_bits <code>5-9</code></li>
<li>timeout <code>milliseconds</code></li>
<li>stop_bits <code>1-2</code></li>
<li>sleep <code>milliseconds</code></li>
<li>parity <code>none, odd, even</code></li>
</ul>
<h3 id=команды>Команды:</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=атрибуты>Атрибуты</h3>
<ul>
<li>произвольный набор</li>
</ul>
<h3 id=статус>Статус</h3>
<ul>
<li>произвольный набор</li>
</ul>
<hr>
<h3 id=доступные-функции>Доступные функции</h3>
<p><strong>1 битные функции</strong></p>
<p>ReadCoils <br>
ReadDiscreteInputs<br>
WriteSingleCoil <br>
WriteMultipleCoils</p>
<p><strong>16 битные функции</strong></p>
<p>ReadInputRegisters <br>
ReadHoldingRegisters <br>
ReadWriteMultipleRegisters<br>
WriteSingleRegister <br>
WriteMultipleRegisters</p>
<hr>
<h3 id=javascript-свойства>javascript свойства</h3>
<ul>
<li>ENTITY_ID</li>
<li>ModbusRtu</li>
<li>entityAction</li>
<li>Action</li>
</ul>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># константа с уникальным id устройства
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>const</span> <span style=color:#000>ENTITY_ID</span>
</code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># выполнение команды(функции) на устройсте:
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>result = </span><span style=color:#000>ModbusRtu</span> <span style=color:#000>func</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>addr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>count</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>command</span>
</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>func</td>
<td>функция для выполнения на устройстве</td>
</tr>
<tr>
<td>addr</td>
<td>Адрес первого регистра (40108-40001 = 107 =6B hex)</td>
</tr>
<tr>
<td>count</td>
<td>Количество требуемых регистров (чтение 3-х регистров с 40108 по 40110)</td>
</tr>
<tr>
<td>command</td>
<td>Команда</td>
</tr>
</tbody>
</table>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># функция-обработчик события действий:
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>entityAction = </span><span style=color:#000>(entityId, actionName)-&gt;</span>
</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>entityId</td>
<td>уникальное id устройства</td>
</tr>
<tr>
<td>actionName</td>
<td>системное наименование действия</td>
</tr>
</tbody>
</table>
<div class="alert alert-warning" role=alert>
Объект <strong>Action</strong> доступен в скриптах действий и скриптах закрепленных за устройством.
</div>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>state = </span><span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>new_state: </span><span style=color:#4e9a06>&#39;ENABLED&#39;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#000>attribute_values: </span><span style=color:#000;font-weight:700>{</span>
    <span style=color:#000>heat: </span><span style=color:#204a87;font-weight:700>false</span>
  <span style=color:#000;font-weight:700>},</span>
  <span style=color:#000>settings_value: </span><span style=color:#000;font-weight:700>{},</span>
  <span style=color:#000>storage_save: </span><span style=color:#204a87;font-weight:700>true</span>
<span style=color:#000;font-weight:700>}</span> 
<span style=color:#8f5902;font-style:italic># сохранение состояния 
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Actor</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>setState</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>state</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><table>
<thead>
<tr>
<th>значение</th>
<th>описание</th>
</tr>
</thead>
<tbody>
<tr>
<td>new_state</td>
<td>уникальное системное наименование состояния</td>
</tr>
<tr>
<td>attribute_values</td>
<td>значения атрибутов ранее определенных для устройства</td>
</tr>
<tr>
<td>settings_value</td>
<td>значения настроек ранее определенных для устройства</td>
</tr>
<tr>
<td>storage_save</td>
<td>признак записи среза состояния в БД</td>
</tr>
</tbody>
</table>
<hr>
<h3 id=пример-coffeescript-кода>пример coffeescript кода</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># ModbusRtu
</span><span style=color:#8f5902;font-style:italic># ##################################
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#4e9a06>&#34;use strict&#34;</span><span style=color:#000;font-weight:700>;</span>

<span style=color:#000>checkStatus = </span><span style=color:#000>-&gt;</span>
  <span style=color:#000>COMMAND = </span><span style=color:#000;font-weight:700>[]</span>
  <span style=color:#000>FUNC = </span><span style=color:#4e9a06>&#39;ReadHoldingRegisters&#39;</span>
  <span style=color:#000>ADDRESS = </span><span style=color:#0000cf;font-weight:700>0</span>
  <span style=color:#000>COUNT = </span><span style=color:#0000cf;font-weight:700>16</span>
  
  <span style=color:#8f5902;font-style:italic># выполнение команды(функции) на устройсте:
</span><span style=color:#8f5902;font-style:italic></span>  <span style=color:#000>res = </span><span style=color:#000>ModbusRtu</span> <span style=color:#000>FUNC</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>ADDRESS</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>COUNT</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>COMMAND</span>
  <span style=color:#000>print</span> <span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>error</span>
  <span style=color:#000>print</span> <span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>result</span>
  <span style=color:#000>print</span> <span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>time</span>

<span style=color:#8f5902;font-style:italic># функция-обработчик события действий:
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>entityAction = </span><span style=color:#000>(entityId, actionName)-&gt;</span>
  <span style=color:#204a87;font-weight:700>switch</span> <span style=color:#000>actionName</span>
    <span style=color:#204a87;font-weight:700>when</span> <span style=color:#4e9a06>&#39;ON&#39;</span> <span style=color:#204a87;font-weight:700>then</span> <span style=color:#000>doOnAction</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>when</span> <span style=color:#4e9a06>&#39;OFF&#39;</span> <span style=color:#204a87;font-weight:700>then</span> <span style=color:#000>doOffAction</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>when</span> <span style=color:#4e9a06>&#39;CHECK&#39;</span> <span style=color:#204a87;font-weight:700>then</span> <span style=color:#000>checkStatus</span><span style=color:#000;font-weight:700>()</span>
    <span style=color:#204a87;font-weight:700>when</span> <span style=color:#4e9a06>&#39;ON_WITH_ERR&#39;</span> <span style=color:#204a87;font-weight:700>then</span> <span style=color:#000>doOnErrAction</span><span style=color:#000;font-weight:700>()</span>

</code></pre></div>
<div class="text-muted mt-5 pt-3 border-top">
Изменено 21.01.2022: <a href=https://github.com/e154/smart-home/commit/8974a146f00f5b270d9720743369fc84400eca1c>github actions (8974a14)</a>
</div>
</div>
</main>
</div>
</div>
<footer class="bg-dark py-5 row d-print-none">
<div class="container-fluid mx-sm-5">
<div class=row>
<div class="col-6 col-sm-4 text-xs-center order-sm-2">
</div>
<div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub>
<a class=text-white target=_blank rel=noopener href=https://github.com/e154/smart-home aria-label=GitHub>
<i class="fab fa-github"></i>
</a>
</li>
</ul>
</div>
<div class="col-12 col-sm-4 text-center py-2 order-sm-2">
<small class=text-white>&copy; 2022 Разработано при поддержке <a href=http://e154.ru>e154.ru</a></small>
<div><small class="ml-1 text-white">Код лицензии <a href=https://github.com/e154/smart-home/blob/master/LICENSE>MIT</a> документы <a href=http://creativecommons.org/licenses/by/3.0/>CC BY 3.0</a></small></div>
</div>
</div>
</div>
</footer>
</div>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script>
<script src=/smart-home/js/tabpane-persist.js></script>
<script src=/smart-home/js/main.min.307d9740a83ff885dafd50af6ce4f79e2146b78e74ee078b11b627d0d02146a9.js integrity="sha256-MH2XQKg/+IXa/VCvbOT3niFGt4507geLEbYn0NAhRqk=" crossorigin=anonymous></script>
</body>
</html>