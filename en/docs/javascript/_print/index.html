<!doctype html><html lang=en class=no-js>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=generator content="Hugo 0.89.4"><link rel=canonical type=text/html href=https://e154.github.io/smart-home/en/docs/javascript/>
<meta name=ROBOTS content="NOINDEX, NOFOLLOW">
<link rel="shortcut icon" href=/smart-home/favicons/favicon.ico>
<link rel=apple-touch-icon href=/smart-home/favicons/apple-touch-icon-180x180.png sizes=180x180>
<link rel=icon type=image/png href=/smart-home/favicons/favicon-16x16.png sizes=16x16>
<link rel=icon type=image/png href=/smart-home/favicons/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/smart-home/favicons/android-36x36.png sizes=36x36>
<link rel=icon type=image/png href=/smart-home/favicons/android-48x48.png sizes=48x48>
<link rel=icon type=image/png href=/smart-home/favicons/android-72x72.png sizes=72x72>
<link rel=icon type=image/png href=/smart-home/favicons/android-96x96.png sizes=96x96>
<link rel=icon type=image/png href=/smart-home/favicons/android-144x144.png sizes=144x144>
<link rel=icon type=image/png href=/smart-home/favicons/android-192x192.png sizes=192x192>
<title>Javascript | Smart home</title>
<meta name=description content="The software logic and applications in the Smart Home project are developed using JavaScript, CoffeeScript, and TypeScript. JavaScript is a …">
<meta property="og:title" content="Javascript">
<meta property="og:description" content="The program complex">
<meta property="og:type" content="website">
<meta property="og:url" content="https://e154.github.io/smart-home/en/docs/javascript/"><meta property="og:site_name" content="Smart home">
<meta itemprop=name content="Javascript">
<meta itemprop=description content="The program complex"><meta name=twitter:card content="summary">
<meta name=twitter:title content="Javascript">
<meta name=twitter:description content="The program complex">
<link rel=preload href=/smart-home/scss/main.min.8ebd0f8570c5c2da16785e52cb8f20394c6d706e75009a748bfe4c38f7ae92c1.css as=style>
<link href=/smart-home/scss/main.min.8ebd0f8570c5c2da16785e52cb8f20394c6d706e75009a748bfe4c38f7ae92c1.css rel=stylesheet integrity>
<script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
</head>
<body class=td-section>
<header>
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
<a class=navbar-brand href=/smart-home/en/>
<span class=navbar-logo></span><span class="text-uppercase font-weight-bold">Smart home</span>
</a>
<div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar>
<ul class="navbar-nav mt-2 mt-lg-0">
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class="nav-link active" href=/smart-home/en/docs/><span class=active>Documentation</span></a>
</li>
<li class="nav-item dropdown mr-4 d-none d-lg-block">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
English
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=/smart-home/docs/javascript/>Русский</a>
</div>
</li>
</ul>
</div>
<div class="navbar-nav d-none d-lg-block">
</div>
</nav>
</header>
<div class="container-fluid td-outer">
<div class=td-main>
<div class="row flex-xl-nowrap">
<div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
</div>
<div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
</div>
<main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main>
<div class=td-content>
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.
</p><p>
<a href=/smart-home/en/docs/javascript/>Return to the regular view of this page</a>.
</p>
</div>
<h1 class=title>Javascript</h1>
<ul>
<li>1: <a href=#pg-f2652915967ab8262030eca600e1a90e>Actor</a></li>
<li>2: <a href=#pg-06d7c61a07052c87c879ee9a9edbc449>Entity</a></li>
<li>3: <a href=#pg-e20be52d8b581bb8e117649fd2265871>entityManager</a></li>
<li>4: <a href=#pg-9da4eb53c4b9af52d6292b0dc7500e49>hex2arr</a></li>
<li>5: <a href=#pg-0680a74cdf0541bf29b386fcca15603d>marshal</a></li>
<li>6: <a href=#pg-a9a66c35c8f75d979eae68e087939baf>Mqtt</a></li>
<li>7: <a href=#pg-ec6a1606c6e250e3fe20a21896c0fc43>print</a></li>
<li>8: <a href=#pg-9c346cca743f679c9d069ea0fb09421c>unmarshal</a></li>
<li>9: <a href=#pg-32950fcaf7eadb1a6af01e12b8d6fccc>Execute</a></li>
<li>10: <a href=#pg-25ccac5b56080fcd6d09c27147bbc75c>Log</a></li>
<li>11: <a href=#pg-def052376f274f2e8abb4278c4e332e3>Storage</a></li>
<li>12: <a href=#pg-35746c1f299b0a71f998b8b6a7ff748a>http</a></li>
</ul>
<div class=content>
<p>The software logic and applications in the <strong>Smart Home</strong> project are developed using JavaScript, CoffeeScript, and TypeScript. JavaScript is a widely-used programming language that provides flexibility and power in creating interactive components.</p>
<p>The <strong>Smart Home</strong> project utilizes JavaScript to write all the core components that control the smart home. This includes device management logic, data processing, interaction with external APIs, creating the user interface, and much more.</p>
<p>In the <strong>Smart Home</strong> project, you can use JavaScript to create automation rules, schedule configurations, process data from sensors, control lighting, heating, security systems, and many other aspects of your smart home. JavaScript enables easy interaction with devices and systems and allows you to create user interfaces to control all the functions of your home.</p>
<p>Thanks to the flexibility and popularity of JavaScript, you can easily customize and extend the <strong>Smart Home</strong> project according to your needs and preferences. You have the opportunity to use a wide range of JavaScript tools and libraries to adapt the project to your unique requirements and enhance its functionality.</p>
<p>Regardless of your programming skills, JavaScript provides a powerful toolkit for developing software logic and applications in the <strong>Smart Home</strong> project.</p>
</div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-f2652915967ab8262030eca600e1a90e>1 - Actor</h1>
<p>In the <strong>Smart Home</strong> project, the JavaScript code includes an accessible object called &ldquo;Actor,&rdquo; which represents a simplified entity model. The Actor object provides convenient methods and properties for interacting with plugin states.</p>
<p>Device State Management: The Actor object provides methods for reading and setting the device state. You can check the current device state and modify it as needed.</p>
<div class="alert alert-warning" role=alert>
The object may not be available in all scopes.
</div>
<p>The &ldquo;Actor&rdquo; object in the <strong>Smart Home</strong> project provides the following methods:</p>
<ol>
<li><code>setState(entityStateParams)</code>: This method allows you to set the state of an actor based on the provided parameters. You pass an <code>entityStateParams</code> object as an argument, which contains the actor&rsquo;s state parameters to be set. For example:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>entityStateParams</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>power</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#000>brightness</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>80</span><span style=color:#000;font-weight:700>,</span>
<span style=color:#000;font-weight:700>};</span>

<span style=color:#000>actor</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>setState</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>entityStateParams</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><ol start=2>
<li><code>getSettings() -> Map[string]any</code>: This method returns the actor&rsquo;s settings as an associative array. The result is a map, where keys are strings and values can be of any data type. You can use this method to retrieve the actor&rsquo;s settings. Example usage:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>settings</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>actor</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>getSettings</span><span style=color:#000;font-weight:700>();</span>
<span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>log</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>settings</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><p>The methods of the &ldquo;Actor&rdquo; object provide functionality for setting the actor&rsquo;s state based on provided parameters and retrieving the actor&rsquo;s settings. You can use these methods to work with actors in your <strong>Smart Home</strong> project and configure their states according to your requirements.</p>
<hr>
<h3 id=actor-object>Actor Object</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># Example of reading device state
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Actor</span>
  <span style=color:#000;font-weight:700>.</span><span style=color:#000>setState</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>entityStateParams</span><span style=color:#000;font-weight:700>)</span>
  <span style=color:#000;font-weight:700>.</span><span style=color:#000>getSettings</span><span style=color:#000>() -&gt;</span> <span style=color:#000>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#000>any</span>
</code></pre></div><h3 id=entitystateparams-object>entityStateParams Object</h3>
<table>
<thead>
<tr>
<th>Value</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>new_state</td>
<td>string</td>
<td>Name of the new state (optional)</td>
</tr>
<tr>
<td>attribute_values</td>
<td>map[string]any</td>
<td>Description of the attributes</td>
</tr>
<tr>
<td>settings_value</td>
<td>map[string]any</td>
<td>Description of the settings</td>
</tr>
<tr>
<td>storage_save</td>
<td>bool</td>
<td>Flag for database storage</td>
</tr>
</tbody>
</table>
<hr>
<h3 id=code-example>Code Example</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>settings = </span><span style=color:#000>Actor</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>getSettings</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>headers = </span><span style=color:#000;font-weight:700>[{</span><span style=color:#4e9a06>&#39;apikey&#39;</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#000>settings</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;apikey&#39;</span><span style=color:#000;font-weight:700>]}]</span>
<span style=color:#000>url = </span><span style=color:#4e9a06>&#39;https://webhook.site/2692a589-a5bc-4156-af7d-75875578798f&#39;</span>
<span style=color:#000>res = </span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>headers</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>headers</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>get</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>url</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-06d7c61a07052c87c879ee9a9edbc449>2 - Entity</h1>
<p>In the <strong>Smart Home</strong> project, the &ldquo;Entity&rdquo; object is the main unit and the primary object that stores the device&rsquo;s state and settings.</p>
<p>An &ldquo;Entity&rdquo; represents an abstraction of a specific device in a smart home. It contains information about the device type, its identifier, current state, and other settings.</p>
<p>The key attributes of an &ldquo;Entity&rdquo; include:</p>
<ol>
<li>
<p>Device Type: Determines the category or class of the device, such as &ldquo;light fixture,&rdquo; &ldquo;thermostat,&rdquo; &ldquo;door lock,&rdquo; etc. This helps classify devices and define the operations and settings available to them.</p>
</li>
<li>
<p>Identifier: A unique identifier assigned to the device, which allows it to be uniquely identified within the smart home system. This can be a numerical value, string, or other identification format.</p>
</li>
<li>
<p>Device State: Contains information about the current state of the device, such as &ldquo;on/off,&rdquo; &ldquo;open/closed,&rdquo; &ldquo;temperature,&rdquo; etc. The state can change as a result of operations or events related to the device.</p>
</li>
<li>
<p>Device Settings: Includes various parameters and settings related to the specific device. For example, these could be brightness settings for a light fixture, preferred temperature for a thermostat, etc.</p>
</li>
</ol>
<p>The &ldquo;Entity&rdquo; serves as the main device abstraction in the <strong>Smart Home</strong> project and provides a unified interface for working with different types of devices. This allows convenient management of device states and settings, as well as the creation of flexible automation scenarios and interactions between devices in your smart home.</p>
<h3 id=entity-object-properties>Entity Object Properties</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000;font-weight:700>{</span>
  <span style=color:#4e9a06>&#34;id&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;sensor.device1&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#4e9a06>&#34;type&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;sensor&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#4e9a06>&#34;description&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;device description&#34;</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#4e9a06>&#34;icon&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#4e9a06>&#34;image_url&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#4e9a06>&#34;actions&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
    <span style=color:#000;font-weight:700>{</span>
      <span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;ENABLE&#34;</span><span style=color:#000;font-weight:700>,</span>
      <span style=color:#4e9a06>&#34;description&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;enable&#34;</span><span style=color:#000;font-weight:700>,</span>
      <span style=color:#4e9a06>&#34;image_url&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#000;font-weight:700>,</span>
      <span style=color:#4e9a06>&#34;icon&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>null</span>
    <span style=color:#000;font-weight:700>},</span>
    <span style=color:#000;font-weight:700>{</span>
      <span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;DISABLE&#34;</span><span style=color:#000;font-weight:700>,</span>
      <span style=color:#4e9a06>&#34;description&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;disable&#34;</span><span style=color:#000;font-weight:700>,</span>
      <span style=color:#4e9a06>&#34;image_url&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#000;font-weight:700>,</span>
      <span style=color:#4e9a06>&#34;icon&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>null</span>
    <span style=color:#000;font-weight:700>}</span>
  <span style=color:#000;font-weight:700>],</span>
  <span style=color:#4e9a06>&#34;states&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000;font-weight:700>[</span>
    <span style=color:#000;font-weight:700>{</span>
      <span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;ENABLED&#34;</span><span style=color:#000;font-weight:700>,</span>
      <span style=color:#4e9a06>&#34;description&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;enabled state&#34;</span><span style=color:#000;font-weight:700>,</span>
      <span style=color:#4e9a06>&#34;image_url&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#000;font-weight:700>,</span>
      <span style=color:#4e9a06>&#34;icon&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>null</span>
    <span style=color:#000;font-weight:700>},</span>
    <span style=color:#000;font-weight:700>{</span>
      <span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;DISABLED&#34;</span><span style=color:#000;font-weight:700>,</span>
      <span style=color:#4e9a06>&#34;description&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;disabled state&#34;</span><span style=color:#000;font-weight:700>,</span>
      <span style=color:#4e9a06>&#34;image_url&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#000;font-weight:700>,</span>
      <span style=color:#4e9a06>&#34;icon&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>null</span>
    <span style=color:#000;font-weight:700>}</span>
  <span style=color:#000;font-weight:700>],</span>
  <span style=color:#4e9a06>&#34;state&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;ENABLED&#34;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#4e9a06>&#34;description&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;enabled state&#34;</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#4e9a06>&#34;image_url&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#4e9a06>&#34;icon&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>null</span>
  <span style=color:#000;font-weight:700>},</span>
  <span style=color:#4e9a06>&#34;attributes&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000;font-weight:700>{},</span>
  <span style=color:#4e9a06>&#34;area&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>null</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#4e9a06>&#34;metrics&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000;font-weight:700>[],</span>
  <span style=color:#4e9a06>&#34;hidden&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>false</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><p>The abstract &ldquo;Entity&rdquo; object in the <strong>Smart Home</strong> project provides the following methods:</p>
<ol>
<li><code>setState(state)</code>: This method allows you to set the device state. You pass the new state as the <code>state</code> argument, which will be applied to the device. For example:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#000>entity</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>setState</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;on&#39;</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><ol start=2>
<li><code>setAttributes(attributes)</code>: This method is used to set the device attributes. You pass an <code>attributes</code> object as an argument, which contains the new attributes to be applied to the device. Example usage:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>newAttributes</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>brightness</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>80</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#000>color</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;red&#39;</span><span style=color:#000;font-weight:700>,</span>
<span style=color:#000;font-weight:700>};</span>

<span style=color:#000>entity</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>setAttributes</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>newAttributes</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><ol start=3>
<li><code>getAttributes()</code>: This method allows you to retrieve the current device attributes. It returns an object with the current attribute values. Example usage:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>attributes</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>entity</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>getAttributes</span><span style=color:#000;font-weight:700>();</span>
<span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>log</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>attributes</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><ol start=4>
<li><code>setMetric(metric, value)</code>: This method allows you to set the device metric. You pass the</li>
</ol>
<p>metric name as the <code>metric</code> argument and the metric value as the <code>value</code> argument. Example usage:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#000>entity</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>setMetric</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;temperature&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>25</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><ol start=5>
<li><code>callAction(action, params)</code>: This method allows you to invoke a specific action on the device. You pass the action name as the <code>action</code> argument and any required parameters as the <code>params</code> argument. Example usage:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#000>entity</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>callAction</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;turnOn&#39;</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><p>The methods of the &ldquo;Entity&rdquo; object provide convenient capabilities for managing the device&rsquo;s state, attributes, metrics, and executing actions on the device. You can use these methods to create device control logic in your <strong>Smart Home</strong> project.</p>
<h3 id=entity-object-methods>Entity Object Methods</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>Entity</span>
  <span style=color:#000;font-weight:700>.</span><span style=color:#000>setState</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>stateName</span><span style=color:#000;font-weight:700>)</span>
  <span style=color:#000;font-weight:700>.</span><span style=color:#000>setAttributes</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>key</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>attrs</span><span style=color:#000;font-weight:700>)</span>
  <span style=color:#000;font-weight:700>.</span><span style=color:#000>getAttributes</span><span style=color:#000>() -&gt;</span> <span style=color:#000>attrs</span>
  <span style=color:#000;font-weight:700>.</span><span style=color:#000>setMetric</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>value</span><span style=color:#000;font-weight:700>)</span>
  <span style=color:#000;font-weight:700>.</span><span style=color:#000>callAction</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>value</span><span style=color:#000;font-weight:700>)</span>
  <span style=color:#000;font-weight:700>.</span><span style=color:#000>getSettings</span><span style=color:#000>() -&gt;</span> <span style=color:#000>map</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>string</span><span style=color:#000;font-weight:700>]</span><span style=color:#000>any</span>
</code></pre></div><table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>setState</code></td>
<td>Sets the current state of the device. <code>stateName</code> - name of the future state.</td>
</tr>
<tr>
<td><code>setAttributes</code></td>
<td>Sets the attributes of the current device state. <code>key</code> - map parameter {key:val}</td>
</tr>
<tr>
<td><code>getAttributes</code></td>
<td>Retrieves the current attributes of the device. <code>attrs</code> - map parameter {key:val}</td>
</tr>
<tr>
<td><code>setMetric</code></td>
<td>Updates the metrics of the device. <code>name</code> - metric name, <code>value</code> - map parameter {key:val}</td>
</tr>
<tr>
<td><code>callAction</code></td>
<td>Executes a command on the device. <code>actionName</code> - name of the command, <code>args</code> - map parameter {key:val}</td>
</tr>
<tr>
<td><code>getSettings</code></td>
<td>Retrieves the settings of the device. <code>settings</code> - map parameter {key:val}</td>
</tr>
</tbody>
</table>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-e20be52d8b581bb8e117649fd2265871>3 - entityManager</h1>
<p>In the <strong>Smart Home</strong> project, there is a device manager called &ldquo;Entity Manager&rdquo; that provides convenient access to devices, their settings, and current state.</p>
<div class="alert alert-success" role=alert>
This function is available in any system script.
</div>
<p>The &ldquo;Entity Manager&rdquo; device manager offers a set of methods and functions for managing devices and retrieving information about them. Some key features of the &ldquo;Entity Manager&rdquo; include:</p>
<ol>
<li>
<p><code>getEntity(id) -> Entity</code>: This method allows you to retrieve an &ldquo;Entity&rdquo; object by its identifier.
You pass the device identifier as the <code>id</code> argument, and the method returns the corresponding &ldquo;Entity&rdquo; object.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>entity</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>entityManager</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>getEntity</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div></li>
<li>
<p><code>setState(id, stateName)</code>: This method is used to set the state of a device with the given identifier.
You pass the device identifier as the <code>id</code> argument and the state name as the <code>stateName</code> argument. For example:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#000>entityManager</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>setState</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;on&#39;</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div></li>
<li>
<p><code>setAttributes(id, attrs)</code>: This method allows you to set attributes for the device with the given identifier.
You pass the device identifier as the <code>id</code> argument and an object with the new attributes as the <code>attrs</code> argument.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>newAttributes</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#000>brightness</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>80</span><span style=color:#000;font-weight:700>,</span>
  <span style=color:#000>color</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;red&#39;</span><span style=color:#000;font-weight:700>,</span>
<span style=color:#000;font-weight:700>};</span>

<span style=color:#000>entityManager</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>setAttributes</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>newAttributes</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div></li>
<li>
<p><code>setMetric(id, name, value)</code>: This method is used to set a metric for the device with the given identifier.
You pass the device identifier as the <code>id</code> argument, the metric name as the <code>name</code> argument, and the metric value as the <code>value</code> argument.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#000>entityManager</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>setMetric</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;temperature&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>25</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div></li>
<li>
<p><code>callAction(id, actionName, args)</code>: This method allows you to invoke a specific action on the device with the given identifier.
You pass the device identifier as the <code>id</code> argument, the action name as the <code>actionName</code> argument, and the action-related arguments as the <code>args</code> argument.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#000>entityManager</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>callAction</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;turnOn&#39;</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div></li>
<li>
<p><code>callScene(id, args)</code>: This method is used to call a scene with the given identifier.
You pass the scene identifier as the <code>id</code> argument and the scene-related arguments as the <code>args</code> argument.</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#000>entityManager</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>callScene</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>args</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div></li>
</ol>
<p>The &ldquo;Entity Manager&rdquo; device manager simplifies the management of devices, settings, and state in the <strong>Smart Home</strong> project. It provides a convenient interface for retrieving information about devices, controlling them, and handling related events. This allows you to create more flexible and functional applications for your smart home.</p>
<hr>
<h3 id=entitymanager-object>entityManager object</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># Available methods
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>entityManager</span>
  <span style=color:#000;font-weight:700>.</span><span style=color:#000>getEntity</span><span style=color:#000>(id) -&gt;</span> <span style=color:#000>Entity</span>
  <span style=color:#000;font-weight:700>.</span><span style=color:#000>setState</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>stateName</span><span style=color:#000;font-weight:700>)</span>
  <span style=color:#000;font-weight:700>.</span><span style=color:#000>setAttributes</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>attrs</span><span style=color:#000;font-weight:700>)</span>
  <span style=color:#000;font-weight:700>.</span><span style=color:#000>setMetric</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>name</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>value</span><span style=color:#000;font-weight:700>)</span>
  <span style=color:#000;font-weight:700>.</span><span style=color:#000>callAction</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>actionName</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>args</span><span style=color:#000;font-weight:700>)</span>
  <span style=color:#000;font-weight:700>.</span><span style=color:#000>callScene</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>id</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>args</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>id</td>
<td>The unique identifier of the device.</td>
</tr>
<tr>
<td>getEntity</td>
<td>Find a device, returns <a href=#entity-object-methods>Entity</a>.</td>
</tr>
<tr>
<td>setState</td>
<td>Set the current state, where <strong>stateName</strong> is the name of the future state.</td>
</tr>
<tr>
<td>setAttributes</td>
<td>Set the attribute of the current state, where <strong>attrs</strong> is a map of parameters {</td>
</tr>
</tbody>
</table>
<p>key: val}. |
| setMetric | Update the device&rsquo;s metrics, where <strong>name</strong> is the name of the metric, and <strong>value</strong> is the metric value. |
| callAction | Execute a command on the device, where <strong>actionName</strong> is the name of the command, and <strong>args</strong> is a map of parameters {key: val}. |
| callScene | Execute a scene with the specified <strong>id</strong>. |</p>
<hr>
<h3 id=code-example>Code Example</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># Entity Manager
</span><span style=color:#8f5902;font-style:italic># ##################################
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#8f5902;font-style:italic># Find a device by its unique id, returns [Entity](#entity-object)
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>device = </span><span style=color:#000>entityManager</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>getEntity</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;telegram.clavicus&#39;</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#8f5902;font-style:italic># Set the current state using the unique state name
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>entityManager</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>setState</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;telegram.clavicus&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;IN_WORK&#39;</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#8f5902;font-style:italic># Set attributes for the current state
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>entityManager</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>setAttributes</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;telegram.clavicus&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#39;temp&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>23.3</span><span style=color:#000;font-weight:700>})</span>

<span style=color:#8f5902;font-style:italic># Update device metrics
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>entityManager</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>setMetric</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;telegram.clavicus&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;cpu&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#39;all&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>55</span><span style=color:#000;font-weight:700>})</span>

<span style=color:#8f5902;font-style:italic># Execute a command on the device
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>entityManager</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>callAction</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;floor.light&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;ON&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#39;power&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>30</span><span style=color:#000;font-weight:700>})</span>

<span style=color:#8f5902;font-style:italic># Get settings
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>settings = </span><span style=color:#000>device</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>getSettings</span><span style=color:#000;font-weight:700>()</span>
<span style=color:#000>headers = </span><span style=color:#000;font-weight:700>[{</span><span style=color:#4e9a06>&#39;apikey&#39;</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#000>settings</span><span style=color:#000;font-weight:700>[</span><span style=color:#4e9a06>&#39;apikey&#39;</span><span style=color:#000;font-weight:700>]}]</span>
<span style=color:#000>url = </span><span style=color:#4e9a06>&#39;https://webhook.site/2692a589-a5bc-4156-af7d-75875578798f&#39;</span>
<span style=color:#000>res = </span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>headers</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>headers</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>get</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>url</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-9da4eb53c4b9af52d6292b0dc7500e49>4 - hex2arr</h1>
<p>The <code>hex2arr(hexString)</code> function is available in a JavaScript environment, and it converts a hexadecimal string to a byte array (<code>[]byte</code>).</p>
<p>Here&rsquo;s an example implementation of the <code>hex2arr</code> function:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#000>hex2arr</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>function</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>hexString</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>[];</span>
    <span style=color:#204a87;font-weight:700>while</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>hexString</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>length</span> <span style=color:#ce5c00;font-weight:700>&gt;=</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>result</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>push</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87>parseInt</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hexString</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>substring</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>),</span> <span style=color:#0000cf;font-weight:700>16</span><span style=color:#000;font-weight:700>));</span>
        <span style=color:#000>hexString</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>hexString</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>substring</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>hexString</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>length</span><span style=color:#000;font-weight:700>);</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>result</span><span style=color:#000;font-weight:700>;</span>
<span style=color:#000;font-weight:700>};</span>
</code></pre></div><p>more examples:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#204a87;font-weight:700>function</span> <span style=color:#000>hex2arr</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hexString</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// Remove all spaces from the string
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#000>hexString</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>hexString</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>replace</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>/\s/g</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#39;&#39;</span><span style=color:#000;font-weight:700>);</span>

    <span style=color:#8f5902;font-style:italic>// Split the string into pairs of characters (each pair represents a byte)
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>hexPairs</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>hexString</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>match</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>/.{1,2}/g</span><span style=color:#000;font-weight:700>);</span>

    <span style=color:#8f5902;font-style:italic>// Convert each pair of characters to a numeric value
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>byteArr</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>hexPairs</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>map</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>function</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>hex</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#204a87>parseInt</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hex</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>16</span><span style=color:#000;font-weight:700>);</span>
    <span style=color:#000;font-weight:700>});</span>

    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>byteArr</span><span style=color:#000;font-weight:700>;</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><p>You can use the <code>hex2arr</code> function as follows:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>hexString</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;48656C6C6F20576F726C64&#34;</span><span style=color:#000;font-weight:700>;</span> <span style=color:#8f5902;font-style:italic>// Hexadecimal representation of &#34;Hello World&#34;
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>byteArr</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>hex2arr</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hexString</span><span style=color:#000;font-weight:700>);</span>
<span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>log</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>byteArr</span><span style=color:#000;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// [ 72, 101, 108, 108, 111, 32, 87, 111, 114, 108, 100 ]
</span></code></pre></div><p>In this example, the <code>hex2arr</code> function takes the hexadecimal string <code>"48656C6C6F20576F726C64"</code>, which represents &ldquo;Hello World&rdquo; in hexadecimal format. The result of the function is a byte array containing the corresponding ASCII values of the characters.</p>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-0680a74cdf0541bf29b386fcca15603d>5 - marshal</h1>
<p>In the JavaScript environment, there is a function called <code>marshal</code> that converts an object into its JSON representation using the <code>JSON.stringify</code> function.</p>
<p>Here&rsquo;s an implementation example of the <code>marshal</code> function:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#204a87;font-weight:700>function</span> <span style=color:#000>marshal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>obj</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>JSON</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>stringify</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>obj</span><span style=color:#000;font-weight:700>);</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><p>Here&rsquo;s an example of using the <code>marshal</code> function:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>obj</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;John&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>age</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#0000cf;font-weight:700>30</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>city</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;New York&#34;</span> <span style=color:#000;font-weight:700>};</span>
<span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>jsonStr</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>marshal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>obj</span><span style=color:#000;font-weight:700>);</span>
<span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>log</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>jsonStr</span><span style=color:#000;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// {&#34;name&#34;:&#34;John&#34;,&#34;age&#34;:30,&#34;city&#34;:&#34;New York&#34;}
</span></code></pre></div><p>In this example, the <code>marshal</code> function takes an object <code>obj</code> and uses the <code>JSON.stringify</code> function to convert the object into its JSON representation. The result of the function will be a JSON string containing the serialized data of the object.</p>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-a9a66c35c8f75d979eae68e087939baf>6 - Mqtt</h1>
<p>The &ldquo;Mqtt&rdquo; object in the <strong>Smart Home</strong> project provides the ability to publish messages to an MQTT broker.</p>
<h4 id=quality-of-service-in-mqtt-qos>Quality of Service in MQTT (QoS)</h4>
<p>QoS 0: At most once. At this level, the publisher sends the message to the broker once and does not wait for confirmation. It means &ldquo;fire and forget.&rdquo;</p>
<p>QoS 1: At least once. This level guarantees that the message will be delivered to the broker, but there is a possibility of message duplication from the publisher. When the broker receives a duplicate message, it resends it to the subscribers and sends an acknowledgment to the publisher. If the publisher doesn&rsquo;t receive a PUBACK message from the broker, it resends the packet with the DUP flag set to &ldquo;1.&rdquo;</p>
<p>QoS 2: Exactly once. This level guarantees the delivery of messages to the subscriber and eliminates the possibility of duplicating sent messages.</p>
<div class="alert alert-success" role=alert>
This function is available in any system script.
</div>
<p>The &ldquo;Mqtt&rdquo; object in the <strong>Smart Home</strong> project provides the following method:</p>
<ol>
<li><code>publish(topic, payload, qos, retain)</code>: This method is used to publish messages to an MQTT broker. You pass the arguments <code>topic</code> (the topic), <code>payload</code> (the message content), <code>qos</code> (Quality of Service level), and <code>retain</code> (the &ldquo;retain&rdquo; flag).</li>
</ol>
<ul>
<li><code>topic</code>: A string representing the topic to which the message will be published.</li>
<li><code>payload</code>: The content of the message, which can be a string, an object, or binary data.</li>
<li><code>qos</code>: The Quality of Service level determines the message delivery guarantees. Possible values are 0 (at most once), 1 (at least once with acknowledgment), or 2 (exactly once with retransmission if needed).</li>
<li><code>retain</code>: A flag indicating whether the message should be retained on the broker and sent to new subscribers. Values can be true (retain) or false (do not retain).</li>
</ul>
<p>Usage example:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>topic</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;smart-home/living-room/light&#39;</span><span style=color:#000;font-weight:700>;</span>
<span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>payload</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;on&#39;</span><span style=color:#000;font-weight:700>;</span>
<span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>qos</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span>
<span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>retain</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#204a87;font-weight:700>true</span><span style=color:#000;font-weight:700>;</span>

<span style=color:#000>Mqtt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>publish</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>topic</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>payload</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>qos</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>retain</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><p>The <code>publish</code> method allows you to send messages to an MQTT broker for transmitting information and controlling devices or the system as a whole in your <strong>Smart Home</strong> project.</p>
<hr>
<h3 id=mqtt-object>Mqtt object</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># Publish a message
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Mqtt</span>
  <span style=color:#000;font-weight:700>.</span><span style=color:#000>publish</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>topic</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>payload</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>qos</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>retain</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>topic</td>
<td>Channel for the message</td>
</tr>
<tr>
<td>payload</td>
<td>JSON object intended for transmission</td>
</tr>
<tr>
<td>qos</td>
<td>Quality of Service (1, 2, 3)</td>
</tr>
<tr>
<td>retain</td>
<td>When publishing data with the retain flag set, the broker will store it. Upon the next subscription to this topic, the broker immediately sends the message with this flag. Only used in PUBLISH messages.</td>
</tr>
</tbody>
</table>
<hr>
<h3 id=code-example>Code Example</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># mqtt
</span><span style=color:#8f5902;font-style:italic># ##################################
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#000>payload = </span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>stringify</span><span style=color:#000;font-weight:700>({</span><span style=color:#4e9a06>&#34;state&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>actionName</span><span style=color:#000;font-weight:700>})</span>
<span style=color:#000>Mqtt</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>publish</span><span style=color:#4e9a06>&#34;zigbee2mqtt/device/set&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>payload</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>false</span><span style=color:#000;font-weight:700>)</span>

</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-ec6a1606c6e250e3fe20a21896c0fc43>7 - print</h1>
<p>In the JavaScript environment, there is a function called <code>print(string)</code> that outputs the specified string to the console.</p>
<p>Example of using the <code>print</code> function:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#000>print</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;Hello, world!&#34;</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><p>In this example, the <code>print</code> function takes the string &ldquo;Hello, world!&rdquo; as an argument and outputs it to the console.</p>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-9c346cca743f679c9d069ea0fb09421c>8 - unmarshal</h1>
<p>В JavaScript-окружении доступна функция <code>unmarshal</code>, которая преобразует JSON-строку в объект с помощью функции <code>JSON.parse</code>.</p>
<p>Пример реализации функции <code>unmarshal</code>:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#204a87;font-weight:700>function</span> <span style=color:#000>unmarshal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>j</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
  <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>JSON</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>parse</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>j</span><span style=color:#000;font-weight:700>);</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><p>Пример использования функции <code>unmarshal</code>:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>jsonStr</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;{&#34;name&#34;:&#34;John&#34;,&#34;age&#34;:30,&#34;city&#34;:&#34;New York&#34;}&#39;</span><span style=color:#000;font-weight:700>;</span>
<span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>obj</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>unmarshal</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>jsonStr</span><span style=color:#000;font-weight:700>);</span>
<span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>log</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>obj</span><span style=color:#000;font-weight:700>);</span> <span style=color:#8f5902;font-style:italic>// { name: &#34;John&#34;, age: 30, city: &#34;New York&#34; }
</span></code></pre></div><p>В этом примере функция <code>unmarshal</code> принимает JSON-строку <code>jsonStr</code> и использует функцию <code>JSON.parse</code> для преобразования строки в объект. Результатом выполнения функции будет объект, содержащий данные из JSON-строки.</p>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-32950fcaf7eadb1a6af01e12b8d6fccc>9 - Execute</h1>
<p>The <strong>Smart Home</strong> project&rsquo;s system provides the ability to execute arbitrary files and scripts synchronously and asynchronously.</p>
<div class="alert alert-success" role=alert>
This function is available in any system script.
</div>
<p>To achieve this, the following methods are available:</p>
<ol>
<li>
<p><code>ExecuteSync(file, args)</code>: This method allows you to execute files and scripts synchronously. You pass the file name or path to the script as the <code>file</code> argument and any required arguments as an object <code>args</code>. Here&rsquo;s an example:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>file</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;script.js&#39;</span><span style=color:#000;font-weight:700>;</span>
<span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>args</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>param1</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;value1&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>param2</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;value2&#39;</span> <span style=color:#000;font-weight:700>};</span>

<span style=color:#000>ExecuteSync</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>file</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>args</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div></li>
<li>
<p><code>ExecuteAsync(file, args)</code>: This method allows you to execute files and scripts asynchronously. The <code>file</code> and <code>args</code> arguments have the same structure as in the <code>ExecuteSync</code> method. Here&rsquo;s an example:</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>file</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;script.js&#39;</span><span style=color:#000;font-weight:700>;</span>
<span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>args</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span> <span style=color:#000>param1</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;value1&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>param2</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;value2&#39;</span> <span style=color:#000;font-weight:700>};</span>

<span style=color:#000>ExecuteAsync</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>file</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>args</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div></li>
</ol>
<p>Both the <code>ExecuteSync</code> and <code>ExecuteAsync</code> methods provide the ability to execute arbitrary files and scripts in your <strong>Smart Home</strong> project. The synchronous mode means that the code execution will block subsequent operations until the script is completed, while the asynchronous mode allows you to continue executing other operations without waiting for the script to finish. You can use these methods for integration with other systems, executing custom scripts, or launching external applications in your <strong>Smart Home</strong> project.</p>
<hr>
<h3 id=code-example>Code Example</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># ExecuteSync
</span><span style=color:#8f5902;font-style:italic># ##################################
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#4e9a06>&#34;use strict&#34;</span><span style=color:#000;font-weight:700>;</span>

<span style=color:#000>r = </span><span style=color:#000>ExecuteSync</span> <span style=color:#4e9a06>&#34;data/scripts/ping.sh&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;google.com&#34;</span>
<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>r</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>out</span> <span style=color:#ce5c00;font-weight:700>==</span> <span style=color:#4e9a06>&#39;ok&#39;</span>
  <span style=color:#000>print</span> <span style=color:#4e9a06>&#34;site is available ^^&#34;</span>
</code></pre></div><p>ping.sh</p>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#8f5902;font-style:italic>#!/usr/bin/env bash
</span><span style=color:#8f5902;font-style:italic></span>
ping -c1 <span style=color:#000>$1</span> &gt; /dev/null 2&gt; /dev/null<span style=color:#000;font-weight:700>;</span> <span style=color:#ce5c00;font-weight:700>[[</span> <span style=color:#000>$?</span> -eq <span style=color:#0000cf;font-weight:700>0</span> <span style=color:#ce5c00;font-weight:700>]]</span> <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> <span style=color:#204a87>echo</span> ok <span style=color:#ce5c00;font-weight:700>||</span> <span style=color:#204a87>echo</span> <span style=color:#4e9a06>&#34;err&#34;</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-25ccac5b56080fcd6d09c27147bbc75c>10 - Log</h1>
<p>In the <strong>Smart Home</strong> project, there is a capability to log events using the &ldquo;Log&rdquo; object.</p>
<div class="alert alert-success" role=alert>
This function is available in any system script.
</div>
<p>The &ldquo;Log&rdquo; object provides the following methods for different logging levels:</p>
<ol>
<li><code>info(txt)</code>: This method is used to log informational messages. You pass the text message as the <code>txt</code> argument. Example usage:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#000>Log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>info</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;This is an informational message.&#39;</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><ol start=2>
<li><code>warn(txt)</code>: This method is used to log warning messages. You pass the text message as the <code>txt</code> argument. Example usage:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#000>Log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>warn</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;This is a warning message.&#39;</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><ol start=3>
<li><code>error(txt)</code>: This method is used to log error messages. You pass the error text message as the <code>txt</code> argument. Example usage:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#000>Log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>error</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;An error occurred.&#39;</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><ol start=4>
<li><code>debug(txt)</code>: This method is used to log debug messages. You pass the debug text message as the <code>txt</code> argument. Example usage:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#000>Log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>debug</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;Debugging information.&#39;</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><p>The methods of the &ldquo;Log&rdquo; object allow you to log various types of messages such as informational messages, warnings, errors, and debug messages. Logging helps track and analyze events occurring in the <strong>Smart Home</strong> project, making it easier for the development, testing, and debugging process of your application.</p>
<hr>
<h3 id=code-examples>Code examples:</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># Log
</span><span style=color:#8f5902;font-style:italic># ##################################
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#000>Log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>info</span> <span style=color:#4e9a06>&#39;some text&#39;</span>
<span style=color:#000>Log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>warn</span> <span style=color:#4e9a06>&#39;some text&#39;</span>
<span style=color:#000>Log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>error</span> <span style=color:#4e9a06>&#39;some text&#39;</span>
<span style=color:#000>Log</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>debug</span> <span style=color:#4e9a06>&#39;some text&#39;</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-def052376f274f2e8abb4278c4e332e3>11 - Storage</h1>
<p>In the <strong>Smart Home</strong> project, there is an <code>in-memory</code> storage provided, which allows you to store and cache arbitrary values in memory. The values are also periodically archived to disk every minute.</p>
<div class="alert alert-success" role=alert>
This function is available in any system script.
</div>
<p>The following methods are available through the &ldquo;Storage&rdquo; object for working with the storage:</p>
<ol>
<li><code>push(key, value)</code>: This method is used to add a value to the storage. You pass the <code>key</code> and <code>value</code> as arguments, which will be stored in memory. Example usage:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#000>Storage</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>push</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;temperature&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>25.5</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><ol start=2>
<li><code>getByName(key)</code>: This method allows you to retrieve a value from the storage based on the specified <code>key</code>. If the value is found in memory, it will be returned. Example usage:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>temperature</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Storage</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>getByName</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;temperature&#39;</span><span style=color:#000;font-weight:700>);</span>
<span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>log</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>temperature</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><ol start=3>
<li><code>search(key)</code>: This method performs a search for a value based on the <code>key</code>. It first searches for the value in memory, and if not found, it searches in the database. The result of the search is returned. Example usage:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Storage</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>search</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;temperature&#39;</span><span style=color:#000;font-weight:700>);</span>
<span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>log</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>result</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><ol start=4>
<li><code>pop(key)</code>: This method removes a value from the storage based on the specified <code>key</code>. If the value is found and removed, the method returns the removed value. Example usage:</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>removedValue</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Storage</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>pop</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;temperature&#39;</span><span style=color:#000;font-weight:700>);</span>
<span style=color:#000>console</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>log</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>removedValue</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><p>The methods of the &ldquo;Storage&rdquo; object provide the ability to add, retrieve, search, and remove values from the <code>in-memory</code> storage. You can use this storage for temporary data storage in memory, with the option to save to disk and perform efficient value search.</p>
<hr>
<h3 id=working-with-the-storage>Working with the storage</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>Storage</span>
  <span style=color:#000;font-weight:700>.</span><span style=color:#000>push</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>key</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>value</span><span style=color:#000;font-weight:700>)</span>
  <span style=color:#000;font-weight:700>.</span><span style=color:#000>getByName</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>key</span><span style=color:#000;font-weight:700>)</span>
  <span style=color:#000;font-weight:700>.</span><span style=color:#000>search</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>key</span><span style=color:#000;font-weight:700>)</span>
  <span style=color:#000;font-weight:700>.</span><span style=color:#000>pop</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>key</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>push</td>
<td>Store a value in the storage with the specified <code>key</code></td>
</tr>
<tr>
<td>getByName</td>
<td>Retrieve a value from the storage based on the specified <code>key</code></td>
</tr>
<tr>
<td>search</td>
<td>Search for a value based on the specified <code>key</code></td>
</tr>
<tr>
<td>pop</td>
<td>Remove a record</td>
</tr>
</tbody>
</table>
<hr>
<h3 id=code-example>Code example</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># Storage
</span><span style=color:#8f5902;font-style:italic># ##################################
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#000>foo =
</span><span style=color:#000></span>  <span style=color:#4e9a06>&#39;bar&#39;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#39;bar&#39;</span>

<span style=color:#000>value = </span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>stringify</span> <span style=color:#000>foo</span>

<span style=color:#8f5902;font-style:italic># save var
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>Storage</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>push</span> <span style=color:#4e9a06>&#39;foo&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>value</span>

<span style=color:#8f5902;font-style:italic># get exist var
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>value = </span><span style=color:#000>Storage</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>getByName</span> <span style=color:#4e9a06>&#39;foo&#39;</span>

<span style=color:#8f5902;font-style:italic># search
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>list = </span><span style=color:#000>Storage</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>search</span> <span style=color:#4e9a06>&#39;bar&#39;</span>

<span style=color:#000>Storage</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>pop</span> <span style=color:#4e9a06>&#39;foo&#39;</span>
</code></pre></div>
</div>
<div class=td-content style=page-break-before:always>
<h1 id=pg-35746c1f299b0a71f998b8b6a7ff748a>12 - http</h1>
<p>In the <strong>Smart Home</strong> project, there is a capability to perform arbitrary synchronous HTTP requests to external resources.</p>
<p>The <code>http</code> object allows you to make synchronous HTTP requests to external resources, such as API services, and receive responses. You can use this method to integrate with other systems and retrieve or send data through the HTTP protocol in your <strong>Smart Home</strong> project.</p>
<p>Supported methods include:</p>
<ul>
<li>GET</li>
<li>POST</li>
<li>PUT</li>
<li>DELETE</li>
</ul>
<div class="alert alert-success" role=alert>
This function is available in any system script.
</div>
<hr>
<p>For this purpose, the corresponding methods are available:</p>
<h3 id=get-request>GET Request</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>response = </span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>get</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>url</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>url</td>
<td>The request URL</td>
</tr>
<tr>
<td>response</td>
<td>The response of the request</td>
</tr>
</tbody>
</table>
<hr>
<h3 id=post-request>POST Request</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>response = </span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>post</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>url</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>body</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>url</td>
<td>The request URL</td>
</tr>
<tr>
<td>body</td>
<td>The request body</td>
</tr>
<tr>
<td>response</td>
<td>The response of the request</td>
</tr>
</tbody>
</table>
<hr>
<h3 id=headers-request>Headers Request</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#000>response = </span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>headers</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>headers</span><span style=color:#000;font-weight:700>).</span><span style=color:#000>post</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>url</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>body</span><span style=color:#000;font-weight:700>)</span>
</code></pre></div><table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>headers</td>
<td>The request headers</td>
</tr>
<tr>
<td>url</td>
<td>The request URL</td>
</tr>
<tr>
<td>body</td>
<td>The request body</td>
</tr>
<tr>
<td>response</td>
<td>The response of the request</td>
</tr>
</tbody>
</table>
<hr>
<h3 id=пример-кода>пример кода</h3>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-coffeescript data-lang=coffeescript><span style=color:#8f5902;font-style:italic># GET http
</span><span style=color:#8f5902;font-style:italic># ##################################
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#000>res = </span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>get</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;%s&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>error</span>
  <span style=color:#204a87;font-weight:700>return</span>
<span style=color:#000>p = </span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>parse</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>body</span><span style=color:#000;font-weight:700>)</span>


<span style=color:#8f5902;font-style:italic># POST http
</span><span style=color:#8f5902;font-style:italic># ##################################
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#000>res = </span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>post</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;%s&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#39;foo&#39;</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#4e9a06>&#39;bar&#39;</span><span style=color:#000;font-weight:700>})</span>
<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>error</span>
  <span style=color:#204a87;font-weight:700>return</span>
<span style=color:#000>p = </span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>parse</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>body</span><span style=color:#000;font-weight:700>)</span>


<span style=color:#8f5902;font-style:italic># PUT http
</span><span style=color:#8f5902;font-style:italic># ##################################
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#000>res = </span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>put</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;%s&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000;font-weight:700>{</span><span style=color:#4e9a06>&#39;foo&#39;</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#4e9a06>&#39;bar&#39;</span><span style=color:#000;font-weight:700>})</span>
<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>error</span>
  <span style=color:#204a87;font-weight:700>return</span>
<span style=color:#000>p = </span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>parse</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>body</span><span style=color:#000;font-weight:700>)</span>


<span style=color:#8f5902;font-style:italic># GET http + custom headers
</span><span style=color:#8f5902;font-style:italic># ##################################
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#000>res = </span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>headers</span><span style=color:#000;font-weight:700>([{</span><span style=color:#4e9a06>&#39;apikey&#39;</span><span style=color:#ce5c00;font-weight:700>:</span><span style=color:#4e9a06>&#39;some text&#39;</span><span style=color:#000;font-weight:700>}]).</span><span style=color:#000>get</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;%s&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>error</span>
<span style=color:#204a87;font-weight:700>return</span>
<span style=color:#000>p = </span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>parse</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>body</span><span style=color:#000;font-weight:700>)</span>

<span style=color:#8f5902;font-style:italic># DELETE http
</span><span style=color:#8f5902;font-style:italic># ##################################
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#000>res = </span><span style=color:#000>http</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>delete</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;%s&#34;</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>error</span>
  <span style=color:#204a87;font-weight:700>return</span>
<span style=color:#000>p = </span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>parse</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>res</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>body</span><span style=color:#000;font-weight:700>)</span>

</code></pre></div>
</div>
</main>
</div>
</div>
<footer class="bg-dark py-5 row d-print-none">
<div class="container-fluid mx-sm-5">
<div class=row>
<div class="col-6 col-sm-4 text-xs-center order-sm-2">
</div>
<div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub>
<a class=text-white target=_blank rel=noopener href=https://github.com/e154/smart-home aria-label=GitHub>
<i class="fab fa-github"></i>
</a>
</li>
</ul>
</div>
<div class="col-12 col-sm-4 text-center py-2 order-sm-2">
<small class=text-white>&copy; 2023 Powered by <a href=http://e154.ru>e154.ru</a></small>
<div><small class="ml-1 text-white"><a href=https://github.com/e154/smart-home/blob/master/LICENSE>MIT</a> License Code Documents <a href=http://creativecommons.org/licenses/by/3.0/>CC BY 3.0</a></small></div>
</div>
</div>
</div>
</footer>
</div>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script>
<script src=/smart-home/js/tabpane-persist.js></script>
<script src=/smart-home/js/main.min.307d9740a83ff885dafd50af6ce4f79e2146b78e74ee078b11b627d0d02146a9.js integrity="sha256-MH2XQKg/+IXa/VCvbOT3niFGt4507geLEbYn0NAhRqk=" crossorigin=anonymous></script>
</body>
</html>